"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[441],{4954:(F,D,c)=>{c.d(D,{m:()=>T});var C=c(3905),p=c(4004),r=c(262),M=c(2340),y=c(2027),x=c(5e3),O=c(520);let T=(()=>{class g{constructor(d){this.http=d,this.serverUrl=M.N.apiServer,this.serverV2Url=M.N.v2apiServer}findReviewWindows(){return this.http.get(this.serverUrl+"window").pipe((0,p.U)(d=>({reviewWindows:d.windows})),(0,r.K)(d=>(console.error(d.error),[])))}getReviewCycleStats(d){return(0,C.z)(this.http.post(this.serverUrl+"talent/window",{windowRId:d}).pipe((0,p.U)(o=>o)))}static formatDates(d){if(d)return Object.assign(Object.assign(Object.assign({},d),d.startDate?{startDate:new y.p({ISODateString:d.startDate})}:{}),d.endDate?{endDate:new y.p({ISODateString:d.endDate})}:{})}getAllReviewCycles(){return(0,C.z)(this.http.get(this.serverV2Url+"review-cycle").pipe((0,p.U)(d=>({reviewCycles:d.map(o=>g.formatDates(o))}))))}getCurrentReviewCycle(){return(0,C.z)(this.http.get(this.serverV2Url+"review-cycle/current").pipe((0,p.U)(d=>({reviewCycle:g.formatDates(d)}))))}createReviewCycle(d){return(0,C.z)(this.http.post(this.serverV2Url+"review-cycle",Object.assign(Object.assign(Object.assign({},d.name?{name:d.name}:{}),d.startDate?{startDate:d.startDate}:{}),d.endDate?{endDate:d.endDate}:{})).pipe((0,p.U)(o=>g.formatDates(o))))}editReviewCycle(d){return(0,C.z)(this.http.put(this.serverV2Url+"review-cycle/"+d._id,Object.assign(Object.assign(Object.assign({},d.name?{name:d.name}:{}),d.startDate?{startDate:d.startDate}:{}),d.endDate?{endDate:d.endDate}:{})).pipe((0,p.U)(o=>g.formatDates(o))))}deleteReviewCycle(d){return(0,C.z)(this.http.delete(this.serverV2Url+"review-cycle/"+d).pipe((0,p.U)(o=>o)))}}return g.\u0275fac=function(d){return new(d||g)(x.LFG(O.eN))},g.\u0275prov=x.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},6441:(F,D,c)=>{c.r(D),c.d(D,{ReviewsModule:()=>ie});var C=c(9808),p=c(2382),r=c(3489),M=c(7531),y=c(7311),x=c(5350),O=c(1217),T=c(5652),g=c(2236),e=c(5e3),d=c(1424);function o(a,h){1&a&&(e.TgZ(0,"span"),e._uU(1,"Add "),e.qZA())}function _(a,h){1&a&&(e.TgZ(0,"span"),e._uU(1,"Edit "),e.qZA())}function n(a,h){if(1&a&&(e.TgZ(0,"div",13),e.TgZ(1,"form",14),e.TgZ(2,"div",15),e.TgZ(3,"div",16),e.TgZ(4,"h6",17),e._uU(5,"Review cycle name"),e.qZA(),e.TgZ(6,"div",18),e._UZ(7,"input",19),e.qZA(),e.qZA(),e.TgZ(8,"div",16),e.TgZ(9,"h6",17),e._uU(10,"Cycle Start Date"),e.qZA(),e.TgZ(11,"div",18),e._UZ(12,"p-calendar",20),e.qZA(),e.qZA(),e.TgZ(13,"div",16),e.TgZ(14,"h6",17),e._uU(15,"Cycle End Date"),e.qZA(),e.TgZ(16,"div",18),e._UZ(17,"p-calendar",21),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.addEditForm),e.xp6(11),e.Q6J("showIcon",!0)("minDate",t.today)("disabled",t.hasStarted),e.xp6(5),e.Q6J("showIcon",!0)("minDate",t.today)}}function v(a,h){if(1&a){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return s.processing=!0,s.onDeleteClick.emit()}),e._UZ(1,"i",23),e._uU(2," Delete "),e.qZA()}}function I(a,h){1&a&&(e.TgZ(0,"span"),e._uU(1,"Add new cycle"),e.qZA())}function k(a,h){1&a&&(e.TgZ(0,"span"),e._uU(1,"Update cycle details"),e.qZA())}let J=(()=>{class a{constructor(t){this.fb=t,this.addingReviewCycle=!0,this.hasStarted=!1,this.canBeDeleted=!1,this.processing=!1,this.onSumbit=new e.vpe,this.onCloseModal=new e.vpe,this.onDeleteClick=new e.vpe,this.today=new Date}ngOnInit(){var t,i,s,l;this.addEditForm=this.fb.group({name:[null===(t=this.existing)||void 0===t?void 0:t.name,p.kI.required],startDate:[null===(i=this.existing)||void 0===i?void 0:i.startDate.date,p.kI.required],endDate:[null===(s=this.existing)||void 0===s?void 0:s.endDate.date,p.kI.required]}),(null===(l=this.existing)||void 0===l?void 0:l._id)&&(this.addingReviewCycle=!1,this.hasStarted=!!this.existing.hasStarted&&this.existing.hasStarted,this.canBeDeleted=!this.hasStarted)}getFormValue(){var t,i,s,l,u,w,m,E,b,A,Z,R;let q=null===(t=this.addEditForm)||void 0===t?void 0:t.value.name,P=null===(i=this.addEditForm)||void 0===i?void 0:i.value.startDate,U=null===(s=this.addEditForm)||void 0===s?void 0:s.value.endDate;return U.setHours(23),U.setMinutes(59),Object.assign(Object.assign(Object.assign(Object.assign({},(null===(l=this.existing)||void 0===l?void 0:l._id)?{_id:null===(u=this.existing)||void 0===u?void 0:u._id}:{}),(null===(w=this.existing)||void 0===w?void 0:w.name)===q?{}:{name:q}),(null===(b=null===(E=null===(m=this.existing)||void 0===m?void 0:m.startDate)||void 0===E?void 0:E.date)||void 0===b?void 0:b.valueOf())===(null==P?void 0:P.valueOf())?{}:{startDate:P}),(null===(R=null===(Z=null===(A=this.existing)||void 0===A?void 0:A.endDate)||void 0===Z?void 0:Z.date)||void 0===R?void 0:R.valueOf())===(null==U?void 0:U.valueOf())?{}:{endDate:U})}clearTalentFromForm(){var t,i,s,l,u,w,m,E,b,A,Z,R;null===(i=null===(t=this.addEditForm)||void 0===t?void 0:t.get("name"))||void 0===i||i.setValue(null),null===(l=null===(s=this.addEditForm)||void 0===s?void 0:s.get("name"))||void 0===l||l.markAsPristine(),null===(w=null===(u=this.addEditForm)||void 0===u?void 0:u.get("startDate"))||void 0===w||w.setValue(null),null===(E=null===(m=this.addEditForm)||void 0===m?void 0:m.get("startDate"))||void 0===E||E.markAsPristine(),null===(A=null===(b=this.addEditForm)||void 0===b?void 0:b.get("endDate"))||void 0===A||A.setValue(null),null===(R=null===(Z=this.addEditForm)||void 0===Z?void 0:Z.get("endDate"))||void 0===R||R.markAsPristine()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(p.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["reviews-add-edit-review-cycle-modal"]],inputs:{existing:"existing",processing:"processing"},outputs:{onSumbit:"onSumbit",onCloseModal:"onCloseModal",onDeleteClick:"onDeleteClick"},decls:20,vars:7,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],[4,"ngIf"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],["class","modal-body",4,"ngIf"],[1,"modal-footer"],[1,"text-right"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"btn","btn-primary","ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-times"],[1,"btn","btn-secondary","ml-1",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-edit"],[1,"modal-body"],[3,"formGroup"],[1,"form-row"],[1,"col-12"],[1,"mb-0"],[1,"p-fluid"],["type","text","pInputText","","formControlName","name"],["formControlName","startDate","dateFormat","dd M yy","icon","fas fa-calendar-alt",3,"showIcon","minDate","disabled"],["formControlName","endDate","dateFormat","dd M yy","icon","fas fa-calendar-alt",3,"showIcon","minDate"],[1,"btn","btn-danger",3,"click"],["aria-hidden","true",1,"fa","fa-trash-alt"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h4",1),e.TgZ(2,"span"),e.YNc(3,o,2,0,"span",2),e.YNc(4,_,2,0,"span",2),e._uU(5," Review Cycle "),e.qZA(),e.qZA(),e.TgZ(6,"button",3),e.NdJ("click",function(l){return i.onCloseModal.emit(l)}),e.TgZ(7,"span",4),e._uU(8,"\xd7"),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,n,18,6,"div",5),e.TgZ(10,"div",6),e.TgZ(11,"div",7),e.YNc(12,v,3,0,"button",8),e.TgZ(13,"button",9),e.NdJ("click",function(l){return i.clearTalentFromForm(),i.onCloseModal.emit(l)}),e._UZ(14,"i",10),e._uU(15," Cancel "),e.qZA(),e.TgZ(16,"button",11),e.NdJ("click",function(){return i.processing=!0,i.onSumbit.emit(i.getFormValue())}),e._UZ(17,"i",12),e.YNc(18,I,2,0,"span",2),e.YNc(19,k,2,0,"span",2),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",i.addingReviewCycle),e.xp6(1),e.Q6J("ngIf",!i.addingReviewCycle),e.xp6(5),e.Q6J("ngIf",i.addEditForm),e.xp6(3),e.Q6J("ngIf",i.canBeDeleted),e.xp6(4),e.Q6J("disabled",(null==i.addEditForm?null:i.addEditForm.invalid)||(null==i.addEditForm?null:i.addEditForm.pristine)),e.xp6(2),e.Q6J("ngIf",i.addingReviewCycle),e.xp6(1),e.Q6J("ngIf",!i.addingReviewCycle))},directives:[C.O5,p._Y,p.JL,p.sg,p.Fj,d.o,p.JJ,p.u,T.f],styles:[""]}),a})();var N=c(727),Y=c(8372),S=c(2027),j=c(4954),Q=c(2733),K=c(9783),W=c(171);function L(a,h){if(1&a&&(e.TgZ(0,"div",2),e.TgZ(1,"div",3),e._UZ(2,"app-shared-review-window-progress",12),e.qZA(),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.Q6J("reviewWindow",t.currentReviewCycle)("totalTalents",t.totalTalents)("reviewedTalents",t.reviewedTalents)}}function H(a,h){if(1&a){const t=e.EpF();e.TgZ(0,"div",13),e.TgZ(1,"button",14),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(),l=e.MAs(23);return s.targetReviewCycle=void 0,s.modalsController.openModal(l)}),e._UZ(2,"i",15),e._uU(3," Add new Review Cycle "),e.qZA(),e.qZA()}}function V(a,h){1&a&&(e.TgZ(0,"div",16),e.TgZ(1,"h6"),e._uU(2,"More"),e.qZA(),e.qZA())}function z(a,h){1&a&&(e.TgZ(0,"span",18),e._uU(1,"Current Cycle"),e.qZA())}function $(a,h){if(1&a){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,l=e.oxw(),u=e.MAs(23);return l.targetReviewCycle=s,l.modalsController.openModal(u)}),e._UZ(1,"i",21),e._uU(2," Edit "),e.qZA()}}function X(a,h){if(1&a&&(e.TgZ(0,"div",16),e.YNc(1,$,3,0,"button",19),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.canBeEdited)}}function G(a,h){if(1&a&&(e.TgZ(0,"div",4),e.TgZ(1,"div",7),e.TgZ(2,"p"),e._uU(3),e.YNc(4,z,2,0,"span",17),e.qZA(),e.qZA(),e.TgZ(5,"div",8),e.TgZ(6,"p"),e._uU(7),e.qZA(),e.qZA(),e.TgZ(8,"div",8),e.TgZ(9,"p"),e._uU(10),e.qZA(),e.qZA(),e.YNc(11,X,2,1,"div",9),e.qZA()),2&a){const t=h.$implicit,i=e.oxw();e.xp6(3),e.hij(" ",t.name||"None on file"," "),e.xp6(1),e.Q6J("ngIf",t.hasStarted&&!t.hasEnded),e.xp6(3),e.AsE("",t.startDate||"None on file"," - ",t.startDate.displayTime(),""),e.xp6(3),e.AsE("",t.endDate||"None on file"," - ",t.endDate.displayTime(),""),e.xp6(1),e.Q6J("ngIf",i.canAddEditReviewCycles)}}function ee(a,h){if(1&a){const t=e.EpF();e.TgZ(0,"reviews-add-edit-review-cycle-modal",22),e.NdJ("onSumbit",function(s){return e.CHM(t),e.oxw().handleAddEditSubmission(s)})("onCloseModal",function(){return e.CHM(t),e.oxw().modalsController.closeUpperModal()})("onDeleteClick",function(){e.CHM(t);const s=e.oxw();return s.handleDelete(null==s.targetReviewCycle?null:s.targetReviewCycle._id)}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("existing",t.targetReviewCycle)("processing",t.processingModalRequest)}}var f=(()=>{return(a=f||(f={}))[a.CREATE=0]="CREATE",a[a.EDIT=1]="EDIT",a[a.DELETE=2]="DELETE",f;var a})();let B=(()=>{class a{constructor(t,i,s,l,u){this.reviewCycleServiceApi=t,this.modalsController=i,this.messageService=s,this.router=l,this.authStateService=u,this.subscriptions=new N.w0,this.today=new S.p,this.aMonthAgo=new S.p,this.canAddEditReviewCycles=!1,this.totalTalents=0,this.reviewedTalents=0,this.allReviewCycles=[],this.processingModalRequest=!1,this.searchInputControl=new p.NI,this.subscriptions.add(this.searchInputControl.valueChanges.pipe((0,Y.b)(350)).subscribe(w=>{this.searchInputControl.valid&&(console.log("New v2 calls"),this.fetchReviewCycles())})),this.subscriptions.add(this.authStateService.authState.subscribe(w=>{let m;w.identity&&(m=w.identity),this.canAddEditReviewCycles="SuperAdmin"==(null==m?void 0:m.role)||"Admin"==(null==m?void 0:m.role)}))}ngOnInit(){this.today=new S.p,this.aMonthAgo=new S.p,this.aMonthAgo.date.setMonth(this.aMonthAgo.date.getMonth()-1),this.fetchCurrentReviewCycle(),this.fetchReviewCycles()}ngOnDestroy(){this.subscriptions.unsubscribe()}fetchCurrentReviewCycle(){this.reviewCycleServiceApi.getCurrentReviewCycle().then(t=>{var i,s;this.currentReviewCycle!==t.reviewCycle&&(this.currentReviewCycle=t.reviewCycle?t.reviewCycle:void 0,this.fetchReviewCycleStats((null===(i=this.currentReviewCycle)||void 0===i?void 0:i._id)?null===(s=this.currentReviewCycle)||void 0===s?void 0:s._id:""))})}fetchReviewCycleStats(t){this.reviewCycleServiceApi.getReviewCycleStats(t).then(i=>{this.totalTalents=i.talentsIgnoreReview?i.talentsIgnoreReview:0,this.reviewedTalents=i.reviewedTalents?i.reviewedTalents:0})}fetchReviewCycles(){this.reviewCycleServiceApi.getAllReviewCycles().then(t=>{t.reviewCycles.length&&(this.allReviewCycles=[]);for(let i of t.reviewCycles){if(null===i._id)continue;const s={_id:i._id,name:i.name,org:i.org,startDate:i.startDate,endDate:i.endDate};s.hasStarted=s.startDate.date.valueOf()<this.today.date.valueOf(),s.hasEnded=s.endDate.date.valueOf()<this.today.date.valueOf(),s.canBeEdited=!1,s.hasStarted?s.endDate.date.valueOf()>this.aMonthAgo.date.valueOf()&&(s.canBeEdited=!0):s.canBeEdited=!0,this.allReviewCycles.push(s)}this.allReviewCycles=this.allReviewCycles.sort((i,s)=>i.startDate.date.valueOf()<s.endDate.date.valueOf()?1:-1)})}handleAddEditSubmission(t){var i,s;let l,u=void 0!==(null===(i=this.targetReviewCycle)||void 0===i?void 0:i._id)?f.EDIT:f.CREATE,w=(null===(s=this.currentReviewCycle)||void 0===s?void 0:s._id)===(null==t?void 0:t._id);switch(u){case f.EDIT:l=this.reviewCycleServiceApi.editReviewCycle(t);break;case f.CREATE:l=this.reviewCycleServiceApi.createReviewCycle(t)}this.processingModalRequest=!0,l.then(m=>this.handleSuccessAddEdit(m,u,w)).catch(m=>this.handleErrorAddEdit(m,u)).finally(()=>{this.processingModalRequest=!1})}handleDelete(t){this.processingModalRequest=!0,this.reviewCycleServiceApi.deleteReviewCycle(t).then(i=>this.handleSuccessAddEdit(i,f.DELETE,!1)).catch(i=>this.handleErrorAddEdit(i,f.DELETE)).finally(()=>{this.processingModalRequest=!1})}handleSuccessAddEdit(t,i,s){let l;switch(i){case f.EDIT:l="Edited Review Cycle";break;case f.CREATE:l="Created new Review Cycle";break;case f.DELETE:l="Deleted Review Cycle"}this.messageService.add({severity:"success",summary:l,detail:"With title "+t.name,life:3e3}),s&&this.fetchCurrentReviewCycle(),this.fetchReviewCycles(),this.modalsController.closeAllModals()}handleErrorAddEdit(t,i){var s;let l,u;switch(i){case f.EDIT:l="Could not edit";break;case f.CREATE:l="Could not create";break;case f.DELETE:l="Could not delete"}switch(null===(s=t.message)||void 0===s?void 0:s.keiroError){case"KE060400":u="Review cycle does not exist";break;case"KE060401":u="The start date must be in the future";break;case"KE060402":u="The start date must be before the end date";break;case"KE060403":u="The dates cannot overlap with other review cycles";break;case"KE060404":u="The review cycle has already ended more than a month ago, it can no longer be modified";break;case"KE060405":u="The start date can't be modified because this review cycle has already begun";break;case"KE060406":u="The end date must be in the future";break;case"KE060407":u="The review cycle has already begun, it can no longer be deleted";break;default:u="Please retry",this.modalsController.closeAllModals()}this.messageService.add({severity:"error",summary:l,detail:u,life:4e3})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(j.m),e.Y36(Q.l),e.Y36(K.ez),e.Y36(y.F0),e.Y36(W.V))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-create-window"]],decls:24,vars:4,consts:[[1,"animated","fadeIn"],["class","card",4,"ngIf"],[1,"card"],[1,"card-body"],[1,"row"],[1,"col-auto"],["class","col text-right",4,"ngIf"],[1,"col-4","col-md-3"],[1,"col-3","col-md-3"],["class","col-2 col-md-3",4,"ngIf"],["class","row",4,"ngFor","ngForOf"],["addEditWindowModal",""],["sectionHeader","Current Review Cycle",3,"reviewWindow","totalTalents","reviewedTalents"],[1,"col","text-right"],[1,"btn","btn-sm","btn-primary",3,"click"],["aria-hidden","true",1,"fa","fa-plus-square"],[1,"col-2","col-md-3"],["class","badge badge-pill badge-primary",4,"ngIf"],[1,"badge","badge-pill","badge-primary"],["class","btn btn-sm btn-secondary",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-pencil-alt"],[3,"existing","processing","onSumbit","onCloseModal","onDeleteClick"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,L,3,3,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"h4"),e._uU(7,"All Review Cycles"),e.qZA(),e.qZA(),e.YNc(8,H,4,0,"div",6),e.qZA(),e.TgZ(9,"div"),e.TgZ(10,"div",4),e.TgZ(11,"div",7),e.TgZ(12,"h6"),e._uU(13,"Review cycle:"),e.qZA(),e.qZA(),e.TgZ(14,"div",8),e.TgZ(15,"h6"),e._uU(16,"Cycle start:"),e.qZA(),e.qZA(),e.TgZ(17,"div",8),e.TgZ(18,"h6"),e._uU(19,"Cycle end:"),e.qZA(),e.qZA(),e.YNc(20,V,3,0,"div",9),e.qZA(),e.YNc(21,G,12,7,"div",10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(22,ee,1,2,"ng-template",null,11,e.W1O)),2&t&&(e.xp6(1),e.Q6J("ngIf",i.currentReviewCycle),e.xp6(7),e.Q6J("ngIf",i.canAddEditReviewCycles),e.xp6(12),e.Q6J("ngIf",i.canAddEditReviewCycles),e.xp6(1),e.Q6J("ngForOf",i.allReviewCycles))},encapsulation:2}),a})();var te=c(6489);let ie=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[y.Bz.forChild([{path:"",component:B}]),C.ez,p.UX,x.nM,r.lN,M.c,O.HC.forRoot(),d.j,T._8,g.B]]}),a})();e.B6R(B,[C.O5,te.v,C.sg,J],[])},1217:(F,D,c)=>{c.d(D,{HC:()=>d,O1:()=>g});var C=c(4559),p=c(9808),r=c(5e3);function M(o,_){if(1&o&&(r.TgZ(0,"bar",2),r.Hsn(1),r.qZA()),2&o){const n=r.oxw();r.Q6J("type",n.type)("value",n._value)}}function y(o,_){if(1&o&&(r.TgZ(0,"bar",2),r._uU(1),r.qZA()),2&o){const n=_.$implicit;r.Q6J("type",n.type)("value",n.value),r.xp6(1),r.Oqu(n.label)}}function x(o,_){if(1&o&&r.YNc(0,y,2,3,"bar",3),2&o){const n=r.oxw();r.Q6J("ngForOf",n._value)}}const O=["*"];let T=(()=>{class o{constructor(){this.animate=!1,this.max=100}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac}),o})(),g=(()=>{class o{constructor(n){this.isStacked=!1,this.addClass=!0,this.bars=[],this._max=100,Object.assign(this,n)}set animate(n){this._animate=n,this.bars.forEach(v=>{v.animate=n})}set striped(n){this._striped=n,this.bars.forEach(v=>{v.striped=n})}set value(n){this.isStacked=Array.isArray(n),this._value=n}get isBs3(){return(0,C.XA)()}get max(){return this._max}set max(n){this._max=n,this.bars.forEach(v=>{v.recalculatePercentage()})}addBar(n){n.animate=this._animate,n.striped=this._striped,this.bars.push(n)}removeBar(n){this.bars.splice(this.bars.indexOf(n),1)}}return o.\u0275fac=function(n){return new(n||o)(r.Y36(T))},o.\u0275cmp=r.Xpm({type:o,selectors:[["progressbar"]],hostVars:3,hostBindings:function(n,v){2&n&&(r.uIk("max",v.max),r.ekj("progress",v.addClass))},inputs:{animate:"animate",striped:"striped",value:"value",max:"max",type:"type"},ngContentSelectors:O,decls:2,vars:2,consts:[[3,"type","value",4,"ngIf"],[3,"ngIf"],[3,"type","value"],[3,"type","value",4,"ngFor","ngForOf"]],template:function(n,v){1&n&&(r.F$t(),r.YNc(0,M,2,2,"bar",0),r.YNc(1,x,1,1,"ng-template",1)),2&n&&(r.Q6J("ngIf",!v.isStacked),r.xp6(1),r.Q6J("ngIf",v.isStacked))},directives:function(){return[p.O5,e,p.sg]},styles:["[_nghost-%COMP%] {\n      width: 100%;\n      display: flex;\n    }"]}),o})(),e=(()=>{class o{constructor(n,v,I){this.el=n,this.renderer=I,this.addClass=!0,this.percent=0,this.progress=v}get type(){return this._type}set type(n){this._type=n,this.applyTypeClasses()}get value(){return this._value}set value(n){!n&&0!==n||(this._value=n,this.recalculatePercentage())}get setBarWidth(){return this.recalculatePercentage(),this.percent}get isBs3(){return(0,C.XA)()}ngOnInit(){this.progress.addBar(this)}ngOnDestroy(){this.progress.removeBar(this)}recalculatePercentage(){this.percent=+(this.value/this.progress.max*100).toFixed(2);const n=this.progress.bars.reduce(function(v,I){return v+I.percent},0);n>100&&(this.percent-=n-100)}applyTypeClasses(){if(this._prevType){const v=`bg-${this._prevType}`;this.renderer.removeClass(this.el.nativeElement,`progress-bar-${this._prevType}`),this.renderer.removeClass(this.el.nativeElement,v),this._prevType=null}if(this._type){const v=`bg-${this._type}`;this.renderer.addClass(this.el.nativeElement,`progress-bar-${this._type}`),this.renderer.addClass(this.el.nativeElement,v),this._prevType=this._type}}}return o.\u0275fac=function(n){return new(n||o)(r.Y36(r.SBq),r.Y36(g,1),r.Y36(r.Qsj))},o.\u0275cmp=r.Xpm({type:o,selectors:[["bar"]],hostAttrs:["role","progressbar","aria-valuemin","0"],hostVars:15,hostBindings:function(n,v){2&n&&(r.uIk("aria-valuenow",v.value)("aria-valuetext",v.percent?v.percent.toFixed(0)+"%":"")("aria-valuemax",v.max),r.Udp("height","100","%")("width",v.setBarWidth,"%"),r.ekj("progress-bar-animated",!v.isBs3&&v.animate)("progress-bar-striped",v.striped)("active",v.isBs3&&v.animate)("progress-bar",v.addClass))},inputs:{type:"type",value:"value"},ngContentSelectors:O,decls:1,vars:0,template:function(n,v){1&n&&(r.F$t(),r.Hsn(0))},encapsulation:2}),o})(),d=(()=>{class o{static forRoot(){return{ngModule:o,providers:[T]}}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[[p.ez]]}),o})()}}]);