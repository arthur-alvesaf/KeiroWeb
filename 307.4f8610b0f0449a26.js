"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[307],{7064:(E,h,i)=>{i.d(h,{i:()=>n});var g=i(9808),e=i(2382),s=i(3077),c=i(3345),m=i(4036),f=i(5e3);let n=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=f.oAB({type:u}),u.\u0275inj=f.cJS({imports:[[g.ez,e.UX,s.mr,c.k,m.kW]]}),u})()},5653:(E,h,i)=>{i.d(h,{iZ:()=>f,vA:()=>c});var g=i(5e3),e=i(1135),s=i(7197),c=(()=>{return(n=c||(c={}))[n.DROPDOWN_SEARCH=0]="DROPDOWN_SEARCH",n[n.TEXT_INPUT=1]="TEXT_INPUT",n[n.TOGGLE=2]="TOGGLE",c;var n})();class m{constructor(u,t){this.valueChanges=new g.vpe,this.metadata=u,this.value=t}set value(u){this.setValue(u)}setValue(u,t=!0,l){this._value=u,t&&this.valueChanges.emit(l)}get value(){return this._value}}let f=(()=>{class n{constructor(t){this._filterGroupSubject=new e.X([]),this.filterGroupsState=this._filterGroupSubject.asObservable(),this.valueChange=new g.vpe,this.lastInformed=void 0,t?(this.dropdownOptions=t.dropdownOptions,this.filtersMetadata=t.filtersMetadata):(this.dropdownOptions=[],this.filtersMetadata=[]);for(const l of this.filtersMetadata)if(l.required){let o=new m(l,"");this.addFilter(o)}}recursiveFindFiltersMetadata(t,l,o=!1){l||(l=this.filtersMetadata);for(const d of l){if(t(d))return d;if(d.children){const v=this.recursiveFindFiltersMetadata(t,d.children);if(v)return o&&this.addFilter(new m(d,"")),v}}}getMetadataWithId(t){return this.recursiveFindFiltersMetadata(l=>l.id==t)}addFilter(t,l=!1,o=!0){let d=this._filterGroupSubject.getValue(),v=d.find(O=>O.groupName==t.metadata.group);if(v){if(!t.metadata.multiple){const O=v.filters.find(M=>M.metadata.id==t.metadata.id);if(O)return void(l&&O.value!=t.value?O.setValue(t.value,!0,{ignoreChange:o}):console.warn("Filter already selected and has value"))}v.filters.push(t)}else v={groupName:t.metadata.group,filters:[t]},d.push(v);t.valueChanges.subscribe(O=>{O&&O.ignoreChange||this.informChange()}),this._filterGroupSubject.next(d)}addFilterWithId(t,l=""){const o=this.recursiveFindFiltersMetadata(d=>d.id==t,void 0,!0);if(o){const d=new m(o,l);this.addFilter(d,!0,!1)}else console.warn("There is no filter with this ID")}canRemoveFilter(t){return!(t.metadata.required||t.metadata.children&&t.metadata.children.length>0&&this.getUngroupedFilters().some(l=>{var o;return null===(o=t.metadata.children)||void 0===o?void 0:o.some(d=>d.id==l.metadata.id)}))}removeFilter(t){if(!this.canRemoveFilter(t))return;let l=this._filterGroupSubject.getValue(),o=l.find(d=>d.groupName==t.metadata.group);o&&(o.filters=o.filters.filter(d=>d!=t),0==o.filters.length&&l.splice(l.indexOf(o),1)),this._filterGroupSubject.next(l),this.informChange()}getUngroupedFilters(){const t=this._filterGroupSubject.getValue();let l=[];for(const o of t)l.push(...o.filters);return l}getSimpleFilterListValue(){let t={};const l=this.getUngroupedFilters();for(const o of l)if(s.g.hasValue(o.value)){if(l.some(d=>d.metadata.children&&d.metadata.children.some(v=>o.metadata.id==v.id)&&!s.g.hasValue(d.value)))continue;Object.keys(t).includes(o.metadata.key)?Array.isArray(t[o.metadata.key])?t[o.metadata.key].push(o.value):t[o.metadata.key]=[t[o.metadata.key],o.value]:t[o.metadata.key]=o.value}return t}informChange(){const t=this.getSimpleFilterListValue();this.isEqual(this.lastInformed,t)||(this.valueChange.emit(t),this.lastInformed=t)}addFilterValues(t){const l=this.getSimpleFilterListValue();for(let o of Object.keys(t)){const d=this.recursiveFindFiltersMetadata(v=>v.key==o);if(d){const v=new m(d,t[o]);this.addFilter(v,!0)}else console.warn("There is no filter with this key")}this.isEqual(this.getSimpleFilterListValue(),l)||this.informChange()}isEqual(t,l){return JSON.stringify(t)==JSON.stringify(l)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG("filterConfiguration",8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})()},851:(E,h,i)=>{i.d(h,{a:()=>S});var g=i(7197),e=i(5e3),s=i(9808),c=i(2382),m=i(8372),f=i(5653),n=i(4036),u=i(9783);function t(a,_){if(1&a&&(e.TgZ(0,"div",7),e.TgZ(1,"em"),e._uU(2),e.qZA(),e.qZA()),2&a){const r=e.oxw(2);e.xp6(2),e.Oqu(r.filter.metadata.visibleName)}}const l=function(){return[]};function o(a,_){if(1&a&&(e.TgZ(0,"p-dropdown",5),e.YNc(1,t,3,1,"ng-template",6),e.qZA()),2&a){const r=e.oxw();e.Q6J("formControl",r.control)("options",r.filter.metadata.options||e.DdM(5,l))("filter",!0)("placeholder",r.filter.metadata.visibleName)("showClear",r.filter.value&&!r.filter.metadata.required)}}function d(a,_){if(1&a&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&a){const r=_.$implicit;e.Q6J("value",r.value),e.xp6(1),e.Oqu(r.name)}}function v(a,_){if(1&a&&(e.TgZ(0,"select",8),e.YNc(1,d,2,2,"option",9),e.qZA()),2&a){const r=e.oxw();e.Q6J("formControl",r.control),e.xp6(1),e.Q6J("ngForOf",r.filter.metadata.options)}}function O(a,_){if(1&a){const r=e.EpF();e.TgZ(0,"a",11),e.NdJ("click",function(){return e.CHM(r),e.oxw().onRemove.emit()}),e._UZ(1,"i",12),e.qZA()}}let M=(()=>{class a{constructor(){this.canRemove=!0,this.filterClass="",this.onRemove=new e.vpe}get FilterType(){return f.vA}ngOnInit(){this.control=new c.NI(this.filter.value),this.control.valueChanges.pipe((0,m.b)(200)).subscribe(r=>{this.filter.value=r}),this.filter.valueChanges.subscribe(()=>{this.control.setValue(this.filter.value,{emitEvent:!1})})}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["alasta-filter-item"]],inputs:{filter:"filter",canRemove:"canRemove",filterClass:"filterClass"},outputs:{onRemove:"onRemove"},decls:5,vars:4,consts:[["id","filter-item",1,"border","border-secondary",3,"ngClass"],["id","filter-value",3,"ngSwitch"],["optionLabel","name","optionValue","value","styleClass","alasta-filter-dropdown",3,"formControl","options","filter","placeholder","showClear",4,"ngSwitchCase"],[3,"formControl",4,"ngSwitchDefault"],["id","filter-remover","class","btn btn-sm btn-secondary-outline p-1",3,"click",4,"ngIf"],["optionLabel","name","optionValue","value","styleClass","alasta-filter-dropdown",3,"formControl","options","filter","placeholder","showClear"],["pTemplate","header"],[1,"filter-dropdown-header"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["id","filter-remover",1,"btn","btn-sm","btn-secondary-outline","p-1",3,"click"],[1,"fas","fa-trash-alt"]],template:function(r,p){1&r&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,o,2,6,"p-dropdown",2),e.YNc(3,v,2,2,"select",3),e.qZA(),e.YNc(4,O,2,0,"a",4),e.qZA()),2&r&&(e.Q6J("ngClass",p.filterClass),e.xp6(1),e.Q6J("ngSwitch",p.filter.metadata.type),e.xp6(1),e.Q6J("ngSwitchCase",p.FilterType.DROPDOWN_SEARCH),e.xp6(2),e.Q6J("ngIf",p.canRemove))},directives:[s.mk,s.RF,s.n9,n.Lt,c.JJ,c.oH,u.jx,s.ED,c.EJ,s.sg,c.YN,c.Kr,s.O5],styles:["#filter-item[_ngcontent-%COMP%]{border-radius:.25rem;display:inline-flex;justify-content:center;align-items:center}#filter-item[_ngcontent-%COMP%]   #filter-remover[_ngcontent-%COMP%]{margin:0 .3rem;width:1.4rem;height:1.4rem;line-height:0;border-radius:.25%}.filter-dropdown-header[_ngcontent-%COMP%]{padding:.2rem .75rem;background-color:#efefef}"]}),a})();var T=i(3077);const x=["selector"];function w(a,_){1&a&&e.Hsn(0,0,["*ngTemplateOutlet","selector ? selector : defaultSelector"])}function P(a,_){if(1&a&&(e.TgZ(0,"span",9),e._uU(1),e.qZA()),2&a){const r=e.oxw().$implicit;e.xp6(1),e.Oqu(r.groupName)}}function D(a,_){if(1&a){const r=e.EpF();e.TgZ(0,"alasta-filter-item",10),e.NdJ("onRemove",function(){const F=e.CHM(r).$implicit;return e.oxw(2).service.removeFilter(F)}),e.qZA()}if(2&a){const r=_.$implicit,p=e.oxw(2);e.Gre("order-",r.metadata.groupOrder," mx-1 mb-1"),e.Q6J("filter",r)("filterClass",p.filterNeedsValue(r)?"border-danger":"")("canRemove",p.service.canRemoveFilter(r))}}function L(a,_){if(1&a&&(e.TgZ(0,"div",5),e.YNc(1,P,2,1,"span",6),e.TgZ(2,"div",7),e.YNc(3,D,1,6,"alasta-filter-item",8),e.qZA(),e.qZA()),2&a){const r=_.$implicit;e.xp6(1),e.Q6J("ngIf",r.groupName),e.xp6(2),e.Q6J("ngForOf",r.filters)}}function R(a,_){if(1&a){const r=e.EpF();e.TgZ(0,"li",17),e.TgZ(1,"button",18),e.NdJ("click",function(){const F=e.CHM(r).$implicit;return e.oxw(3).service.addFilterWithId(F.id)}),e._uU(2),e.qZA(),e.qZA()}if(2&a){const r=_.$implicit,p=e.oxw(3);e.xp6(1),e.Q6J("disabled",p.canSelectDropdownOption(r.id)),e.xp6(1),e.hij(" ",r.name," ")}}function U(a,_){if(1&a&&(e.TgZ(0,"ul",15),e.YNc(1,R,3,2,"li",16),e.qZA()),2&a){const r=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",r.service.dropdownOptions)}}function A(a,_){1&a&&(e.TgZ(0,"div",11),e.TgZ(1,"button",12),e._uU(2," Add filter "),e._UZ(3,"span",13),e.qZA(),e.YNc(4,U,2,1,"ul",14),e.qZA())}const I=["*"];let S=(()=>{class a{constructor(){}ngOnInit(){}canSelectDropdownOption(r){return!!this.service.getUngroupedFilters().some(p=>p.metadata.id==r&&!p.metadata.multiple)}filterNeedsValue(r){return!(g.g.hasValue(r.value)||!r.metadata.children||!this.service.getUngroupedFilters().some(p=>{var C;return(null===(C=r.metadata.children)||void 0===C?void 0:C.some(F=>F.id==p.metadata.id))&&g.g.hasValue(p.value)}))}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["alasta-filters-list"]],contentQueries:function(r,p,C){if(1&r&&e.Suo(C,x,5),2&r){let F;e.iGM(F=e.CRH())&&(p.selector=F.first)}},inputs:{service:"service"},ngContentSelectors:I,decls:7,vars:4,consts:[["id","filters-list",1,"d-flex","flex-wrap"],["id","filters-dropdown",1,"mr-1"],[4,"ngTemplateOutlet"],["class","filter-group border border-primary mr-1 mb-1",4,"ngFor","ngForOf"],["defaultSelector",""],[1,"filter-group","border","border-primary","mr-1","mb-1"],["class","filter-group-title",4,"ngIf"],[1,"d-flex","flex-wrap"],[3,"class","filter","filterClass","canRemove","onRemove",4,"ngFor","ngForOf"],[1,"filter-group-title"],[3,"filter","filterClass","canRemove","onRemove"],["dropdown","",1,"btn-group"],["id","filter-dropdown-button","dropdownToggle","","type","button","aria-controls","filter-dropdown",1,"btn","btn-primary","dropdown-toggle"],[1,"caret"],["id","filter-dropdown","class","dropdown-menu","role","menu","aria-labelledby","filter-dropdown-button",4,"dropdownMenu"],["id","filter-dropdown","role","menu","aria-labelledby","filter-dropdown-button",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item",3,"disabled","click"]],template:function(r,p){if(1&r&&(e.F$t(),e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,w,1,0,"ng-content",2),e.qZA(),e.YNc(3,L,4,2,"div",3),e.ALo(4,"async"),e.qZA(),e.YNc(5,A,5,0,"ng-template",null,4,e.W1O)),2&r){const C=e.MAs(6);e.xp6(2),e.Q6J("ngTemplateOutlet",p.selector?p.selector:C),e.xp6(1),e.Q6J("ngForOf",e.lcZ(4,2,p.service.filterGroupsState))}},directives:[s.tP,s.sg,s.O5,M,T.TO,T.Mq,T.Hz],pipes:[s.Ov],styles:[".filter-group[_ngcontent-%COMP%]{border-radius:.25rem}.filter-group[_ngcontent-%COMP%] > .filter-group-title[_ngcontent-%COMP%]{display:block;font-size:.8rem;margin:0 .8rem}"]}),a})()},797:(E,h,i)=>{i.d(h,{_:()=>f});var g=i(4004),e=i(262),s=i(2340),c=i(5e3),m=i(520);let f=(()=>{class n{constructor(t){this.http=t,this.serverUrl=s.N.apiServer,this.serverV2Url=s.N.v2apiServer}findDistinctLocations(t,l){return this.http.post(this.serverUrl+"location/filter-distinct",Object.assign(Object.assign({},t?{country:t}:{}),l?{location:l}:{})).pipe((0,g.U)(o=>({countries:o.distinctOptions[0].countries,properties:o.distinctOptions[0].locations})),(0,e.K)(o=>(console.error(o.error),[])))}getAllProperties(){return this.http.get(this.serverV2Url+"property").pipe((0,g.U)(t=>({properties:t})),(0,e.K)(t=>(console.error(t.error),[])))}}return n.\u0275fac=function(t){return new(t||n)(c.LFG(m.eN))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},4954:(E,h,i)=>{i.d(h,{m:()=>f});var g=i(4004),e=i(262),s=i(2340),c=i(5e3),m=i(520);let f=(()=>{class n{constructor(t){this.http=t,this.serverUrl=s.N.apiServer}findReviewWindows(){return this.http.get(this.serverUrl+"window").pipe((0,g.U)(t=>({reviewWindows:t.windows})),(0,e.K)(t=>(console.error(t.error),[])))}}return n.\u0275fac=function(t){return new(t||n)(c.LFG(m.eN))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},8254:(E,h,i)=>{i.d(h,{M:()=>f});var g=i(4004),e=i(262),s=i(2340),c=i(5e3),m=i(520);let f=(()=>{class n{constructor(t){this.http=t,this.serverUrl=s.N.apiServer}getBoxes(){return this.http.get(this.serverUrl+"box").pipe((0,g.U)(t=>({boxes:t.boxes})),(0,e.K)(t=>(console.error(t.error),[])))}}return n.\u0275fac=function(t){return new(t||n)(c.LFG(m.eN))},n.\u0275prov=c.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},7197:(E,h,i)=>{i.d(h,{g:()=>g});class g{static hasValue(s){return null!=s&&null!=s&&""!==s}}},2338:(E,h,i)=>{i.d(h,{F:()=>g});class g{static encodeObjectToURLParam(s,c=""){const m=Object.keys(s).map(f=>{const n=s[f];return s.constructor===Array?f=`${c}[]`:s.constructor===Object&&(f=c?`${c}[${f}]`:f),"object"==typeof n?this.encodeObjectToURLParam(n,f):`${f}=${encodeURIComponent(n)}`});return[].concat.apply([],m).join("&")}static decodeURLParamToObject(s){let c={};for(const m of s.split("&")){let[f,n]=m.split("=");n=decodeURIComponent(n),this.handleSingleValue(c,f,n)}return c}static handleSingleValue(s,c,m){if(c.includes("["))if("[]"==c)s.push(m);else{const f=c.indexOf("["),n=c.indexOf("]"),u=c.substring(0,f);if(f+1==n){const t=c.substring(f);if(""!=u)null==s[u]&&(s[u]=[]),this.handleSingleValue(s[u],t,m);else{const l=c.substring(n+1),o=l.indexOf("["),d=l.indexOf("]");if(o+1==d){let v=[];s.push(v),this.handleSingleValue(v,l,m)}else{const v=l.substring(o+1,d)+l.substring(d+1);let O={};s.push(O),this.handleSingleValue(O,v,m)}}}else{const t=c.substring(f+1,n)+c.substring(n+1);null==s[u]&&(s[u]={}),this.handleSingleValue(s[u],t,m)}}else s[c]=m}}}}]);