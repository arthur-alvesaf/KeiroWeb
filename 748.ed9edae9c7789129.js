"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[748],{9621:(I,f,l)=>{l.r(f),l.d(f,{CreateTalentModule:()=>et});var o=l(9808),h=l(7311),v=l(8430),C=l(2382),A=l(1217),T=l(8397),b=l(8099),c=l(2306),m=l(3345),s=l(5861),t=l(5e3),Z=l(727),_=l(7197),u=l(625),p=l(582),N=l(171),M=l(9649),V=l(2733),y=l(921),k=l(2962),w=l(549),F=l(1507);function E(n,i){1&n&&(t.TgZ(0,"span",35),t._UZ(1,"app-shared-icon-tooltip",36),t.qZA())}function U(n,i){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.AsE(" : ",(null==e?null:e.currentTalentValue).firstNames," ",(null==e?null:e.currentTalentValue).lastNames," ")}}function J(n,i){if(1&n&&(t.TgZ(0,"span"),t.YNc(1,E,2,0,"span",34),t.YNc(2,U,2,2,"span",19),t.qZA()),2&n){const e=t.oxw().$implicit,a=t.oxw();t.xp6(1),t.Q6J("ngIf","INVALID"===e._talentStatus),t.xp6(1),t.Q6J("ngIf",a.ifTalentValueSet(e,"firstNames")&&a.ifTalentValueSet(e,"lastNames"))}}function R(n,i){1&n&&(t.TgZ(0,"div",37),t._UZ(1,"i",38),t.TgZ(2,"em"),t._uU(3,"Saved"),t.qZA(),t.qZA())}function L(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit;return t.oxw().removeRow(r)}),t._UZ(1,"i",40),t._uU(2,"Remove entry "),t.qZA()}}const S=function(n){return["/","app","talent","view",n]};function Q(n,i){if(1&n&&(t.TgZ(0,"a",41),t._uU(1," View in new tab "),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(1,S,null==e.saved?null:e.saved._id))}}function O(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1," This form has not been completed yet "),t.qZA())}function q(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1," There was a problem in the server while saving this talent "),t.qZA())}function D(n,i){if(1&n&&(t.TgZ(0,"div",42),t.YNc(1,O,2,0,"span",19),t.YNc(2,q,2,0,"span",19),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","INCOMPLETE"==e.error),t.xp6(1),t.Q6J("ngIf","SERVER_ERROR"==e.error)}}function Y(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",43),t.NdJ("click",function(){return t.CHM(e),t.oxw().$implicit.removeAccountSection()}),t._UZ(1,"i",44),t._uU(2,"Remove account "),t.qZA()}}function P(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"keiro-account-form",45),t.NdJ("valueChanges",function(r){return t.CHM(e),t.oxw().$implicit.currentAccountValue=r})("statusChanges",function(r){return t.CHM(e),t.oxw().$implicit.accountStatus=r}),t.qZA()}if(2&n){const e=t.oxw().$implicit,a=t.oxw();t.Q6J("disabled",e.disabled)("touchForm",e.touch)("canCreateRoles",a.canCreateRoles)}}function B(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",48),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).$implicit.addAccountSection()}),t._UZ(1,"i",49),t._uU(2,"Add Account for Talent "),t.qZA()}}function $(n,i){if(1&n&&(t.TgZ(0,"div",46),t.YNc(1,B,3,0,"button",47),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.canManageAccounts&&!e.showAlastaAccountSection)}}const H=function(n,i){return{"fa-chevron-up":n,"fa-chevron-down":i}};function W(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",12),t.TgZ(2,"div",13),t.TgZ(3,"div",14),t.TgZ(4,"div",15),t.TgZ(5,"button",16),t.NdJ("click",function(){const d=t.CHM(e).$implicit;return d.formVisible=!d.formVisible}),t.TgZ(6,"h6",17),t._UZ(7,"i",18),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"div",4),t.TgZ(9,"em"),t._uU(10),t.qZA(),t.YNc(11,J,3,2,"span",19),t.YNc(12,R,4,0,"div",20),t.qZA(),t.TgZ(13,"div",21),t.YNc(14,L,3,0,"button",22),t.YNc(15,Q,2,3,"a",23),t.qZA(),t.qZA(),t.TgZ(16,"div",24),t.YNc(17,D,3,2,"div",25),t.TgZ(18,"div",26),t.TgZ(19,"h6",27),t._uU(20,"General information"),t.qZA(),t.TgZ(21,"talent-form",28),t.NdJ("valueChanges",function(r){return t.CHM(e).$implicit.currentTalentValue=r})("statusChanges",function(r){return t.CHM(e).$implicit.talentStatus=r}),t.qZA(),t.qZA(),t.TgZ(22,"div",29),t._UZ(23,"hr",30),t.TgZ(24,"h6",27),t._uU(25," Keiro Account "),t.YNc(26,Y,3,0,"button",31),t.qZA(),t.YNc(27,P,1,3,"keiro-account-form",32),t.qZA(),t.YNc(28,$,2,1,"div",33),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=i.$implicit,a=i.index,r=t.oxw();t.xp6(1),t.Q6J("ngClass",e.cssClass),t.xp6(4),t.Udp("font-size",100,"%"),t.xp6(2),t.Q6J("ngClass",t.WLB(23,H,e.formVisible,!e.formVisible)),t.xp6(3),t.hij("Talent form #",a+1,""),t.xp6(1),t.Q6J("ngIf",!e.formVisible),t.xp6(1),t.Q6J("ngIf",e.saved),t.xp6(2),t.Q6J("ngIf",!e.saved),t.xp6(1),t.Q6J("ngIf",e.saved),t.xp6(1),t.Q6J("collapse",!e.formVisible)("isAnimated",!0),t.xp6(1),t.Q6J("ngIf",e.error),t.xp6(4),t.Q6J("disabled",e.disabled)("allNationalities",r.allNationalities)("allLanguages",r.allLanguages)("touchForm",e.touch),t.xp6(1),t.Q6J("collapse",!e.showAlastaAccountSection)("isAnimated",!0),t.xp6(1),t.Udp("width",85,"%"),t.xp6(3),t.Q6J("ngIf",e.canManageAccounts&&!e.saved),t.xp6(1),t.Q6J("ngIf",e.showAlastaAccountSection),t.xp6(1),t.Q6J("ngIf",!e.saved)}}function j(n,i){if(1&n&&(t.TgZ(0,"li",55),t.TgZ(1,"div",14),t.TgZ(2,"div",4),t._uU(3),t.qZA(),t.TgZ(4,"div",15),t.TgZ(5,"a",56),t._uU(6,"View talent in new tab"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n){const e=i.$implicit;t.xp6(3),t.AsE(" ",null==e.saved||null==e.saved.name?null:e.saved.name.given," ",null==e.saved||null==e.saved.name?null:e.saved.name.last," "),t.xp6(2),t.Q6J("routerLink",t.VKq(3,S,null==e||null==e.saved?null:e.saved._id))}}function G(n,i){if(1&n&&(t.TgZ(0,"div",52),t.TgZ(1,"h6",27),t._uU(2),t.qZA(),t.TgZ(3,"ul",53),t.YNc(4,j,7,5,"li",54),t.qZA(),t.qZA()),2&n){const e=t.oxw(2);t.xp6(2),t.hij("Saved talents (",e.savedTalents.length,")"),t.xp6(2),t.Q6J("ngForOf",e.savedTalents)}}function K(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"bulk-save-progress-modal",50),t.NdJ("close",function(){return t.CHM(e),t.oxw().closeModal()}),t.YNc(1,G,5,2,"div",51),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("progress",e.savingProgress),t.xp6(1),t.Q6J("ngIf",0!==(null==e.savedTalents?null:e.savedTalents.length))}}class z{constructor(){this.formVisible=!0,this.disabled=!1,this.defaultCssClass="border-secondary",this.cssClass=this.defaultCssClass,this.touch=new t.vpe,this.canManageAccounts=!0,this.showAlastaAccountSection=!1}set currentTalentValue(i){this.error=void 0,this._currentTalentValue=i}get currentTalentValue(){return this._currentTalentValue}set talentStatus(i){this._talentStatus=i,this.updateCssClass()}set currentAccountValue(i){this.error=void 0,this._currentAccountValue=i}get currentAccountValue(){return this._currentAccountValue}set accountStatus(i){this._accountStatus=i,this.updateCssClass()}addAccountSection(){this.showAlastaAccountSection=!0,this.updateCssClass()}removeAccountSection(){this.showAlastaAccountSection=!1,this.updateCssClass()}updateCssClass(){"INVALID"!==this.getSimplifiedStatus()?this.saved?setTimeout(()=>{this.cssClass="border-success"}):setTimeout(()=>{this.cssClass=this.defaultCssClass}):setTimeout(()=>{this.cssClass="border-danger"})}getSimplifiedStatus(){return this.showAlastaAccountSection&&"INVALID"===this._accountStatus||"INVALID"===this._talentStatus?"INVALID":this._talentStatus}}let X=(()=>{class n{constructor(e,a,r,d,g){this.router=e,this.authStateService=a,this.talentManagementServiceApi=r,this.modalsController=d,this.sessionStateService=g,this.inputTalentForms=[],this.allLanguages=[],this.allNationalities=[],this.canCreateRolesString=[],this.canCreateRoles=[],this.canHideForm=!0,this.canHideAccountSection=!1,this.talentsToAddQueue=[],this.savingProgress=new p.jh(0),this.savedTalents=[],this.subscriptions=new Z.w0,this.subscriptions.add(this.authStateService.authState.subscribe(x=>{if(x.identity){if(this.currentUser=x.identity,"Admin"==this.currentUser.role)return void(this.canCreateRoles=[u.u.EMPLOYEE,u.u.MANAGER,u.u.ADMIN]);if("Manager"==this.currentUser.role)return void(this.canCreateRoles=[u.u.EMPLOYEE]);if("SuperAdmin"==this.currentUser.role)return void(this.canCreateRoles=[u.u.EMPLOYEE,u.u.MANAGER,u.u.ADMIN])}}))}ngOnInit(){var e=this;return(0,s.Z)(function*(){e.getAllLanguages().then(a=>e.getAllNationalities()).then(a=>e.addNewRow()).catch(a=>e.handleFatalError())})()}ngOnDestroy(){this.subscriptions.unsubscribe()}prettifyError(e){return e?e.required?"Required":e.min||e.max?"Invalid":e.notInteger||e.notNumeric?"Not number":e.valueNotInOptions?"Unknown value":e.email?"Not valid email address":e.emailInUse?`Email address already in use by ${e.associatedTalent}`:e.minlength||e.maxlength?"Invalid length":e.matDatepickerMin||e.matDatepickerMax?"Invalid date":e.allOrNothing?"Incomplete work information":"":""}addNewRow(){this.sessionStateService.registerActivity();let e=new z;this.inputTalentForms.push(e)}removeRow(e){this.sessionStateService.registerActivity();const a=this.inputTalentForms.indexOf(e);this.inputTalentForms.splice(a,1);const r=this.savedTalents.indexOf(e);-1!=r&&this.savedTalents.splice(r,1)}ifTalentValueSet(e,a){return void 0!==e.currentTalentValue&&_.g.hasValue(e.currentTalentValue[a])}ifAccountValueSet(e,a){return void 0!==e.currentAccountValue&&_.g.hasValue(e.currentAccountValue[a])}saveTalents(e){this.sessionStateService.registerActivity(),this.talentsToAddQueue=this.inputTalentForms.filter(a=>!a.saved).map(a=>(a.error=void 0,a.touch.emit(),a)),this.savingProgress=new p.jh(this.talentsToAddQueue.length),this.savingProgress.status=p.Wg.IN_PROGRESS,this.modalsController.openModal(e,{ignoreBackdropClick:!0,keyboard:!1}),this.saveNextTalent()}saveNextTalent(){if(this.sessionStateService.registerActivity(),this.savingProgress.pending--,0==this.talentsToAddQueue.length)return void(this.savingProgress.status=p.Wg.FINISHED);const e=this.talentsToAddQueue.shift();if(void 0!==e){if("VALID"!==e.getSimplifiedStatus())return this.handleSaveFail(),e.error="INCOMPLETE",void this.saveNextTalent();void 0!==e.currentTalentValue&&this.talentManagementServiceApi.createTalent(e.currentTalentValue,e.currentAccountValue).then(a=>{this.handleSaveSuccess(e),e.saved=a.talent,e.formVisible=!1,this.savedTalents.push(e)}).catch(a=>{this.handleSaveFail(),e.error="SERVER_ERROR"}).finally(()=>{this.saveNextTalent()})}}handleSaveSuccess(e){this.savingProgress.successful++,this.savingProgress.progressBarDisplay[p.CX.SUCCESS].value++,e.disabled=!0}handleSaveFail(){this.savingProgress.failed++,this.savingProgress.progressBarDisplay[p.CX.FAILURE].value++}handleFatalError(){alert("An error ocurred, please try again"),this.router.navigate(["app/talent/finder"])}closeModal(){this.modalsController.closeUpperModal()}getAllLanguages(){var e=this;return(0,s.Z)(function*(){const a=yield e.talentManagementServiceApi.getSupportedLanguages();e.allLanguages=a.languages})()}getAllNationalities(){var e=this;return(0,s.Z)(function*(){const a=yield e.talentManagementServiceApi.getSupportedCountries();e.allNationalities=a.countries})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.F0),t.Y36(N.V),t.Y36(M.C),t.Y36(V.l),t.Y36(y.W))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-talent"]],decls:17,vars:3,consts:[[1,"animated","fadeIn"],[1,"card"],[1,"card-body"],[1,"form-row","mb-2"],[1,"col"],[1,"col-auto","col-sm-4"],["title","Save list of talents",1,"btn","btn-block","btn-success",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-paper-plane","mr-1"],[4,"ngFor","ngForOf"],[1,"mt-2","mb-1","btn","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-plus","mr-1"],["savingInProcessModal",""],[1,"align-items-center","border","rounded","my-1","shadow-sm",3,"ngClass"],[1,"col","my-3"],[1,"form-row"],[1,"col-auto"],[1,"btn","btn-light","rounded-pill","text-center",3,"click"],[1,"m-0","p-0"],["aria-hidden","true",1,"fa",3,"ngClass"],[4,"ngIf"],["class","ml-1 d-inline-block text-success",4,"ngIf"],[1,"col-12","col-sm-auto","text-right"],["class","btn btn-sm btn-outline-danger","title","Remove this entry",3,"click",4,"ngIf"],["class","btn btn-link","target","_blank",3,"routerLink",4,"ngIf"],[1,"pt-2",3,"collapse","isAnimated"],["id","formError","class","p-error block",4,"ngIf"],["id","generalInfoSection"],[1,"mb-0"],[3,"disabled","allNationalities","allLanguages","touchForm","valueChanges","statusChanges"],["id","accountSection",3,"collapse","isAnimated"],[1,"my-2"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[3,"disabled","touchForm","canCreateRoles","valueChanges","statusChanges",4,"ngIf"],["id","sectionsControl","class","mt-2",4,"ngIf"],["class","mx-1",4,"ngIf"],[1,"mx-1"],["accentLevel","warning","iconClasses","fa fa-exclamation-circle","tooltipMessage","This talent form has not been completed yet"],[1,"ml-1","d-inline-block","text-success"],["aria-hidden","true",1,"fa","fa-check","mr-1"],["title","Remove this entry",1,"btn","btn-sm","btn-outline-danger",3,"click"],["aria-hidden","true",1,"fa","fa-minus","mr-1"],["target","_blank",1,"btn","btn-link",3,"routerLink"],["id","formError",1,"p-error","block"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["aria-hidden","true",1,"fa","fa-door-closed","mr-1"],[3,"disabled","touchForm","canCreateRoles","valueChanges","statusChanges"],["id","sectionsControl",1,"mt-2"],["class","btn btn-sm btn-outline-primary",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],["aria-hidden","true",1,"fa","fa-door-open","mr-1"],["savingResource","talent",3,"progress","close"],["class","my-2 p-1",4,"ngIf"],[1,"my-2","p-1"],[1,"list-group","list-group-flush","mb-2"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],["target","_blank",3,"routerLink"]],template:function(e,a){if(1&e){const r=t.EpF();t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"h4"),t._uU(6,"New talents"),t.qZA(),t.qZA(),t.TgZ(7,"div",5),t.TgZ(8,"button",6),t.NdJ("click",function(){t.CHM(r);const g=t.MAs(16);return a.saveTalents(g)}),t._UZ(9,"i",7),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.YNc(11,W,29,26,"div",8),t.TgZ(12,"button",9),t.NdJ("click",function(){return a.addNewRow()}),t._UZ(13,"i",10),t._uU(14,"Add a new entry "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(15,K,2,2,"ng-template",null,11,t.W1O)}2&e&&(t.xp6(8),t.Q6J("disabled",0==a.inputTalentForms.length),t.xp6(2),t.hij("Save talents (",a.inputTalentForms.length-a.savedTalents.length,") "),t.xp6(1),t.Q6J("ngForOf",a.inputTalentForms))},directives:[o.sg,o.mk,o.O5,k.s,h.yS,v.Y,w.V,F.g,p.ng],encapsulation:2}),n})();var tt=l(2342);let et=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[h.Bz.forChild([{path:"",component:X}]),o.ez,C.UX,v.f,A.HC.forRoot(),T.z8,c.t,m.k,b.B,tt.M]]}),n})()},242:(I,f,l)=>{l.d(f,{Iu:()=>b,Ql:()=>T});var o=l(5e3),h=l(9808),v=l(2382);const C=function(c,m,s){return{"p-inputswitch p-component":!0,"p-inputswitch-checked":c,"p-disabled":m,"p-focus":s}},A={provide:v.JU,useExisting:(0,o.Gpc)(()=>T),multi:!0};let T=(()=>{class c{constructor(s){this.cd=s,this.trueValue=!0,this.falseValue=!1,this.onChange=new o.vpe,this.modelValue=!1,this.focused=!1,this.onModelChange=()=>{},this.onModelTouched=()=>{}}onClick(s,t){!this.disabled&&!this.readonly&&(s.preventDefault(),this.toggle(s),t.focus())}onInputChange(s){this.readonly||this.updateModel(s,s.target.checked)}toggle(s){this.updateModel(s,!this.checked())}updateModel(s,t){this.modelValue=t?this.trueValue:this.falseValue,this.onModelChange(this.modelValue),this.onChange.emit({originalEvent:s,checked:this.modelValue})}onFocus(s){this.focused=!0}onBlur(s){this.focused=!1,this.onModelTouched()}writeValue(s){this.modelValue=s,this.cd.markForCheck()}registerOnChange(s){this.onModelChange=s}registerOnTouched(s){this.onModelTouched=s}setDisabledState(s){this.disabled=s,this.cd.markForCheck()}checked(){return this.modelValue===this.trueValue}}return c.\u0275fac=function(s){return new(s||c)(o.Y36(o.sBO))},c.\u0275cmp=o.Xpm({type:c,selectors:[["p-inputSwitch"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",tabindex:"tabindex",inputId:"inputId",name:"name",disabled:"disabled",readonly:"readonly",trueValue:"trueValue",falseValue:"falseValue",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{onChange:"onChange"},features:[o._Bn([A])],decls:5,vars:16,consts:[[3,"ngClass","ngStyle","click"],[1,"p-hidden-accessible"],["type","checkbox","role","switch",3,"checked","disabled","change","focus","blur"],["cb",""],[1,"p-inputswitch-slider"]],template:function(s,t){if(1&s){const Z=o.EpF();o.TgZ(0,"div",0),o.NdJ("click",function(u){o.CHM(Z);const p=o.MAs(3);return t.onClick(u,p)}),o.TgZ(1,"div",1),o.TgZ(2,"input",2,3),o.NdJ("change",function(u){return t.onInputChange(u)})("focus",function(u){return t.onFocus(u)})("blur",function(u){return t.onBlur(u)}),o.qZA(),o.qZA(),o._UZ(4,"span",4),o.qZA()}2&s&&(o.Tol(t.styleClass),o.Q6J("ngClass",o.kEZ(12,C,t.checked(),t.disabled,t.focused))("ngStyle",t.style),o.xp6(2),o.Q6J("checked",t.checked())("disabled",t.disabled),o.uIk("aria-label",t.ariaLabel)("id",t.inputId)("name",t.name)("tabindex",t.tabindex)("aria-checked",t.checked())("aria-labelledby",t.ariaLabelledBy))},directives:[h.mk,h.PC],styles:['.p-inputswitch{position:relative;display:inline-block;-webkit-user-select:none;user-select:none}.p-inputswitch-slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0}.p-inputswitch-slider:before{position:absolute;content:"";top:50%}\n'],encapsulation:2,changeDetection:0}),c})(),b=(()=>{class c{}return c.\u0275fac=function(s){return new(s||c)},c.\u0275mod=o.oAB({type:c}),c.\u0275inj=o.cJS({imports:[[h.ez]]}),c})()}}]);