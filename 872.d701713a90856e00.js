"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[872],{9147:(x,S,g)=>{g.d(S,{Ib:()=>u,Vg:()=>p,ub:()=>A});var o=g(3905),e=g(4004),I=g(2340),v=g(5e3),D=g(520),p=(()=>{return(l=p||(p={}))[l.CANDIDATE=0]="CANDIDATE",l[l.CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED=1]="CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED",l[l.CANDIDATE_ENDED_NOT_DESIRED=2]="CANDIDATE_ENDED_NOT_DESIRED",l[l.ACTIVE=10]="ACTIVE",l[l.ENDED=19]="ENDED",l[l.CHANGE_PROMOTION=20]="CHANGE_PROMOTION",l[l.CHANGE_LATERAL_MOVEMENT=21]="CHANGE_LATERAL_MOVEMENT",l[l.CHANGE_TRANSFER_SAME_POSITION=22]="CHANGE_TRANSFER_SAME_POSITION",l[l.CHANGE_TRANSFER_PROMOTION=23]="CHANGE_TRANSFER_PROMOTION",l[l.DISMISSAL_VOLUNTARY_ABSENTEEISM=50]="DISMISSAL_VOLUNTARY_ABSENTEEISM",l[l.DISMISSAL_VOLUNTARY_ABANDONMENT=51]="DISMISSAL_VOLUNTARY_ABANDONMENT",l[l.DISMISSAL_VOLUNTARY_RETIREMENT=52]="DISMISSAL_VOLUNTARY_RETIREMENT",l[l.DISMISSAL_VOLUNTARY_BETTER_OFFER=53]="DISMISSAL_VOLUNTARY_BETTER_OFFER",l[l.DISMISSAL_VOLUNTARY_PERSONAL=54]="DISMISSAL_VOLUNTARY_PERSONAL",l[l.DISMISSAL_FORCED_END_OF_CONTRACT=70]="DISMISSAL_FORCED_END_OF_CONTRACT",l[l.DISMISSAL_FORCED_DISEASE=71]="DISMISSAL_FORCED_DISEASE",l[l.DISMISSAL_FORCED_DEATH=72]="DISMISSAL_FORCED_DEATH",l[l.DISMISSAL_FORCED_LOW_PERFORMANCE=73]="DISMISSAL_FORCED_LOW_PERFORMANCE",l[l.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS=74]="DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS",l[l.DISMISSAL_FORCED_OTHERS=75]="DISMISSAL_FORCED_OTHERS",p;var l})();class A{}A.forcedDismissalReasons=[p.DISMISSAL_FORCED_END_OF_CONTRACT,p.DISMISSAL_FORCED_DISEASE,p.DISMISSAL_FORCED_DEATH,p.DISMISSAL_FORCED_LOW_PERFORMANCE,p.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS,p.DISMISSAL_FORCED_OTHERS],A.statusNameMap=new Map([[p.CANDIDATE,"Candidate"],[p.CANDIDATE_ENDED_NOT_SELECTED_BUT_DESIRED,"Candidate ended but not selected"],[p.CANDIDATE_ENDED_NOT_DESIRED,"Candidate not desired"],[p.ACTIVE,"Active"],[p.ENDED,"Ended"],[p.CHANGE_PROMOTION,"Promotion"],[p.CHANGE_LATERAL_MOVEMENT,"Lateral movement"],[p.CHANGE_TRANSFER_SAME_POSITION,"Transfer same position"],[p.CHANGE_TRANSFER_PROMOTION,"Transfer promotion"],[p.DISMISSAL_VOLUNTARY_ABSENTEEISM,"Absenteeism"],[p.DISMISSAL_VOLUNTARY_ABANDONMENT,"Abandonment"],[p.DISMISSAL_VOLUNTARY_RETIREMENT,"Retirement"],[p.DISMISSAL_VOLUNTARY_BETTER_OFFER,"Better offer"],[p.DISMISSAL_VOLUNTARY_PERSONAL,"Personal"],[p.DISMISSAL_FORCED_END_OF_CONTRACT,"End of contract"],[p.DISMISSAL_FORCED_DISEASE,"Disease"],[p.DISMISSAL_FORCED_DEATH,"Death"],[p.DISMISSAL_FORCED_LOW_PERFORMANCE,"Low performance"],[p.DISMISSAL_FORCED_INAPROPIATE_BEHAVIORS,"Inapropiate behaviors"],[p.DISMISSAL_FORCED_OTHERS,"Other"]]);let u=(()=>{class l{constructor(_){this.http=_,this.serverUrl=I.N.v2apiServer}static formatDates(_){return Object.assign(Object.assign(Object.assign({},_),_.from?{from:new Date(_.from)}:{}),_.until?{until:new Date(_.until)}:{})}createEmploymentRecord(_,C,b,T,O){return(0,o.z)(this.http.post(this.serverUrl+"employment/",Object.assign({job:_,talent:C,status:b,from:T.toISOString()},O?{allowMultiple:O}:{})).pipe((0,e.U)(r=>l.formatDates(r))))}getEmploymentsForTalent(_){return(0,o.z)(this.http.get(this.serverUrl+"employment/talent/"+_).pipe((0,e.U)(C=>C.map(b=>l.formatDates(b)))))}editEmployment(_,C,b,T,O){return(0,o.z)(this.http.put(this.serverUrl+"employment/"+_,Object.assign(Object.assign(Object.assign({from:C.toISOString()},void 0!==b?{status:b}:{}),void 0!==T?{until:T}:{}),void 0!==O?{notes:O}:{})).pipe((0,e.U)(r=>l.formatDates(r))))}endEmployment(_,C,b,T){return(0,o.z)(this.http.put(this.serverUrl+"employment/"+_,Object.assign({status:C,until:b.toISOString()},T?{notes:T}:{})).pipe((0,e.U)(O=>l.formatDates(O))))}}return l.\u0275fac=function(_){return new(_||l)(v.LFG(D.eN))},l.\u0275prov=v.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},4053:(x,S,g)=>{g.d(S,{U:()=>A});var o=g(3905),e=g(4004),I=g(2340),v=g(9147),D=g(5e3),p=g(520);let A=(()=>{class u{constructor(f){this.http=f,this.serverUrl=I.N.v2apiServer}getTeamByLeader(f){return(0,o.z)(this.http.get(this.serverUrl+"team/"+f).pipe((0,e.U)(_=>Object.assign(Object.assign(Object.assign({},_),_.employment?{employment:v.Ib.formatDates(_.employment)}:{}),{teamMembers:_.teamMembers.map(C=>Object.assign(Object.assign({},C),C.employment?{employment:v.Ib.formatDates(C.employment)}:{}))}))))}getRelevantJobByTalent(f){return(0,o.z)(this.http.get(this.serverUrl+"team/relevant-job/"+f).pipe((0,e.U)(_=>_)))}getTopMostJobInHierarchy(){return(0,o.z)(this.http.get(this.serverUrl+"team/top-most-job/").pipe((0,e.U)(f=>f)))}addEndedEmployment(f,_,C,b,T,O,r){return(0,o.z)(this.http.post(this.serverUrl+"team/ended-employment",Object.assign({title:void 0,leaderJob:void 0,property:f,position:_,talent:C,status:b,from:T,until:O},r?{notes:r}:{})).pipe((0,e.U)(m=>m)))}addJob(f,_,C){return(0,o.z)(this.http.post(this.serverUrl+"job/",{leader:f,property:_,position:C}).pipe((0,e.U)(b=>b)))}removeJob(f){return(0,o.z)(this.http.delete(this.serverUrl+"job/"+f).pipe((0,e.U)(_=>_)))}}return u.\u0275fac=function(f){return new(f||u)(D.LFG(p.eN))},u.\u0275prov=D.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},3872:(x,S,g)=>{g.r(S),g.d(S,{JobsModule:()=>ee});var o=g(9808),e=g(5e3),I=g(727),v=g(4053),D=g(171),p=g(7311),A=g(8652),u=g(1777),l=g(9783),f=g(7579);const _=["pOrganizationChartNode",""];function C(n,c){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.node.label)}}function b(n,c){1&n&&e.GkF(0)}const T=function(n){return{$implicit:n}};function O(n,c){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,b,1,0,"ng-container",7),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngTemplateOutlet",t.chart.getTemplateForNode(t.node))("ngTemplateOutletContext",e.VKq(2,T,t.node))}}const r=function(n,c){return{"pi-chevron-down":n,"pi-chevron-up":c}};function m(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"a",8),e.NdJ("click",function(s){e.CHM(t);const h=e.oxw(2);return h.toggleNode(s,h.node)})("keydown.enter",function(s){e.CHM(t);const h=e.oxw(2);return h.toggleNode(s,h.node)}),e._UZ(1,"i",9),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(1,r,t.node.expanded,!t.node.expanded))}}function a(n,c){if(1&n&&(e.ynx(0),e.TgZ(1,"td"),e._UZ(2,"div",4),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",t.colspan)}}const d=function(n){return{"p-organizationchart-line-top":n}};function N(n,c){if(1&n&&(e.TgZ(0,"td",11),e._uU(1,"\xa0"),e.qZA(),e.TgZ(2,"td",12),e._uU(3,"\xa0"),e.qZA()),2&n){const i=c.last;e.Q6J("ngClass",e.VKq(2,d,!c.first)),e.xp6(2),e.Q6J("ngClass",e.VKq(4,d,!i))}}function E(n,c){if(1&n&&(e.ynx(0),e.YNc(1,N,4,6,"ng-template",10),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.node.children)}}function z(n,c){if(1&n&&(e.TgZ(0,"td",13),e._UZ(1,"table",14),e.qZA()),2&n){const t=c.$implicit;e.xp6(1),e.Q6J("node",t)}}const Z=function(n,c){return{"p-organizationchart-node-content":!0,"p-organizationchart-selectable-node":n,"p-highlight":c}};function F(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"tbody"),e.TgZ(1,"tr"),e.TgZ(2,"td"),e.TgZ(3,"div",1),e.NdJ("click",function(s){e.CHM(t);const h=e.oxw();return h.onNodeClick(s,h.node)}),e.YNc(4,C,2,1,"div",0),e.YNc(5,O,2,4,"div",0),e.YNc(6,m,2,4,"a",2),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"tr",3),e.TgZ(8,"td"),e._UZ(9,"div",4),e.qZA(),e.qZA(),e.TgZ(10,"tr",3),e.YNc(11,a,3,1,"ng-container",0),e.YNc(12,E,2,1,"ng-container",0),e.qZA(),e.TgZ(13,"tr",5),e.YNc(14,z,2,1,"td",6),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.uIk("colspan",t.colspan),e.xp6(1),e.Tol(t.node.styleClass),e.Q6J("ngClass",e.WLB(17,Z,t.chart.selectionMode&&!1!==t.node.selectable,t.isSelected())),e.xp6(1),e.Q6J("ngIf",!t.chart.getTemplateForNode(t.node)),e.xp6(1),e.Q6J("ngIf",t.chart.getTemplateForNode(t.node)),e.xp6(1),e.Q6J("ngIf",!t.leaf),e.xp6(1),e.Q6J("ngClass",!t.leaf&&t.node.expanded?"p-organizationchart-node-visible":"p-organizationchart-node-hidden")("@childState","in"),e.xp6(1),e.uIk("colspan",t.colspan),e.xp6(2),e.Q6J("ngClass",!t.leaf&&t.node.expanded?"p-organizationchart-node-visible":"p-organizationchart-node-hidden")("@childState","in"),e.xp6(1),e.Q6J("ngIf",t.node.children&&1===t.node.children.length),e.xp6(1),e.Q6J("ngIf",t.node.children&&t.node.children.length>1),e.xp6(1),e.Q6J("ngClass",!t.leaf&&t.node.expanded?"p-organizationchart-node-visible":"p-organizationchart-node-hidden")("@childState","in"),e.xp6(1),e.Q6J("ngForOf",t.node.children)}}function P(n,c){if(1&n&&e._UZ(0,"table",2),2&n){const t=e.oxw();e.Q6J("node",t.root)}}const B=function(n){return{"p-organizationchart p-component":!0,"p-organizationchart-preservespace":n}};let J=(()=>{class n{constructor(t,i){this.cd=i,this.chart=t,this.subscription=this.chart.selectionSource$.subscribe(()=>{this.cd.markForCheck()})}get leaf(){return 0!=this.node.leaf&&!(this.node.children&&this.node.children.length)}get colspan(){return this.node.children&&this.node.children.length?2*this.node.children.length:null}onNodeClick(t,i){this.chart.onNodeClick(t,i)}toggleNode(t,i){i.expanded=!i.expanded,i.expanded?this.chart.onNodeExpand.emit({originalEvent:t,node:this.node}):this.chart.onNodeCollapse.emit({originalEvent:t,node:this.node}),t.preventDefault()}isSelected(){return this.chart.isSelected(this.node)}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36((0,e.Gpc)(()=>U)),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["","pOrganizationChartNode",""]],hostAttrs:[1,"p-element"],inputs:{node:"node",root:"root",first:"first",last:"last"},attrs:_,decls:1,vars:1,consts:[[4,"ngIf"],[3,"ngClass","click"],["tabindex","0","class","p-node-toggler",3,"click","keydown.enter",4,"ngIf"],[1,"p-organizationchart-lines",3,"ngClass"],[1,"p-organizationchart-line-down"],[1,"p-organizationchart-nodes",3,"ngClass"],["colspan","2",4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["tabindex","0",1,"p-node-toggler",3,"click","keydown.enter"],[1,"p-node-toggler-icon","pi",3,"ngClass"],["ngFor","",3,"ngForOf"],[1,"p-organizationchart-line-left",3,"ngClass"],[1,"p-organizationchart-line-right",3,"ngClass"],["colspan","2"],["pOrganizationChartNode","",1,"p-organizationchart-table",3,"node"]],template:function(t,i){1&t&&e.YNc(0,F,15,20,"tbody",0),2&t&&e.Q6J("ngIf",i.node)},directives:[n,o.O5,o.mk,o.tP,o.sg],styles:[".p-organizationchart-table{border-spacing:0;border-collapse:separate;margin:0 auto}.p-organizationchart-table>tbody>tr>td{text-align:center;vertical-align:top;padding:0 .75rem}.p-organizationchart-node-content{display:inline-block;position:relative}.p-organizationchart-node-content .p-node-toggler{position:absolute;bottom:-.75rem;margin-left:-.75rem;z-index:2;left:50%;-webkit-user-select:none;user-select:none;cursor:pointer;width:1.5rem;height:1.5rem}.p-organizationchart-node-content .p-node-toggler .p-node-toggler-icon{position:relative;top:.25rem}.p-organizationchart-line-down{margin:0 auto;height:20px;width:1px}.p-organizationchart-line-right,.p-organizationchart-line-left{border-radius:0}.p-organizationchart-selectable-node{cursor:pointer}.p-organizationchart .p-organizationchart-node-hidden{display:none}.p-organizationchart-preservespace .p-organizationchart-node-hidden{visibility:hidden;display:inherit}\n"],encapsulation:2,data:{animation:[(0,u.X$)("childState",[(0,u.SB)("in",(0,u.oB)({opacity:1})),(0,u.eR)("void => *",[(0,u.oB)({opacity:0}),(0,u.jt)(150)]),(0,u.eR)("* => void",[(0,u.jt)(150,(0,u.oB)({opacity:0}))])])]},changeDetection:0}),n})(),U=(()=>{class n{constructor(t,i){this.el=t,this.cd=i,this.preserveSpace=!0,this.selectionChange=new e.vpe,this.onNodeSelect=new e.vpe,this.onNodeUnselect=new e.vpe,this.onNodeExpand=new e.vpe,this.onNodeCollapse=new e.vpe,this.selectionSource=new f.x,this.selectionSource$=this.selectionSource.asObservable()}get selection(){return this._selection}set selection(t){this._selection=t,this.initialized&&this.selectionSource.next(null)}get root(){return this.value&&this.value.length?this.value[0]:null}ngAfterContentInit(){this.templates.length&&(this.templateMap={}),this.templates.forEach(t=>{this.templateMap[t.getType()]=t.template}),this.initialized=!0}getTemplateForNode(t){return this.templateMap?t.type?this.templateMap[t.type]:this.templateMap.default:null}onNodeClick(t,i){let s=t.target;if((!s.className||-1===s.className.indexOf("p-node-toggler")&&-1===s.className.indexOf("p-node-toggler-icon"))&&this.selectionMode){if(!1===i.selectable)return;let h=this.findIndexInSelection(i),M=h>=0;"single"===this.selectionMode?M?(this.selection=null,this.onNodeUnselect.emit({originalEvent:t,node:i})):(this.selection=i,this.onNodeSelect.emit({originalEvent:t,node:i})):"multiple"===this.selectionMode&&(M?(this.selection=this.selection.filter((R,y)=>y!=h),this.onNodeUnselect.emit({originalEvent:t,node:i})):(this.selection=[...this.selection||[],i],this.onNodeSelect.emit({originalEvent:t,node:i}))),this.selectionChange.emit(this.selection),this.selectionSource.next(null)}}findIndexInSelection(t){let i=-1;if(this.selectionMode&&this.selection)if("single"===this.selectionMode)i=this.selection==t?0:-1;else if("multiple"===this.selectionMode)for(let s=0;s<this.selection.length;s++)if(this.selection[s]==t){i=s;break}return i}isSelected(t){return-1!=this.findIndexInSelection(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["p-organizationChart"]],contentQueries:function(t,i,s){if(1&t&&e.Suo(s,l.jx,4),2&t){let h;e.iGM(h=e.CRH())&&(i.templates=h)}},hostAttrs:[1,"p-element"],inputs:{value:"value",style:"style",styleClass:"styleClass",selectionMode:"selectionMode",preserveSpace:"preserveSpace",selection:"selection"},outputs:{selectionChange:"selectionChange",onNodeSelect:"onNodeSelect",onNodeUnselect:"onNodeUnselect",onNodeExpand:"onNodeExpand",onNodeCollapse:"onNodeCollapse"},decls:2,vars:7,consts:[[3,"ngStyle","ngClass"],["class","p-organizationchart-table","pOrganizationChartNode","",3,"node",4,"ngIf"],["pOrganizationChartNode","",1,"p-organizationchart-table",3,"node"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,P,1,1,"table",1),e.qZA()),2&t&&(e.Tol(i.styleClass),e.Q6J("ngStyle",i.style)("ngClass",e.VKq(5,B,i.preserveSpace)),e.xp6(1),e.Q6J("ngIf",i.root))},directives:[J,o.PC,o.mk,o.O5],encapsulation:2,changeDetection:0}),n})(),w=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[o.ez],l.m8]}),n})();const k=function(n){return{j:n}};function j(n,c){if(1&n&&(e.TgZ(0,"a",7),e._UZ(1,"i",8),e._uU(2," View in Job Navigator "),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("queryParams",e.VKq(1,k,t.selected[0].key))}}function Y(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).triggerLeaderChange()}),e._UZ(1,"i",10),e._uU(2," Move leader "),e.qZA()}}function Q(n,c){if(1&n&&(e.TgZ(0,"div",4),e.YNc(1,j,3,3,"a",5),e.YNc(2,Y,3,0,"button",6),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",1===t.selected.length),e.xp6(1),e.Q6J("ngIf",t.canMoveLeader&&t.selected.length>=1)}}function W(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).submitMoveLeader()}),e._UZ(1,"i",10),e._uU(2," Choose as leader "),e.qZA()}}function H(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",4),e.YNc(2,W,3,0,"button",11),e.qZA(),e.TgZ(3,"div",12),e.TgZ(4,"h5"),e._uU(5,"Hierarchy Change Mode"),e.qZA(),e._uU(6),e._UZ(7,"br"),e.TgZ(8,"strong"),e._uU(9,"Please note:"),e.qZA(),e._uU(10," this action is not recommended. It is intended to correct mistakes when defining the hierarchy."),e._UZ(11,"br"),e.TgZ(12,"button",13),e.NdJ("click",function(){return e.CHM(t),e.oxw().cancelLeaderChange()}),e._uU(13,"Click here to cancel"),e.qZA(),e._uU(14),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.selected.length>=1),e.xp6(4),e.hij(" You have selected ",t.jobsToMove.length," jobs to move in the hierarchy."),e.xp6(8),e.hij(" or select the leader of the ",t.jobsToMove.length," selected jobs. ")}}function V(n,c){1&n&&(e.TgZ(0,"p",18),e._UZ(1,"i",19),e._uU(2,"Vacant job "),e.qZA()),2&n&&e.Udp("line-height",1.2)("font-size",.7,"em")}function q(n,c){if(1&n&&(e.TgZ(0,"p",15),e._uU(1),e.qZA(),e.TgZ(2,"p",16),e._uU(3),e.qZA(),e.TgZ(4,"p",16),e._uU(5),e.qZA(),e.TgZ(6,"p",15),e._uU(7),e.qZA(),e.YNc(8,V,3,4,"p",17)),2&n){const t=c.$implicit;e.Udp("line-height",1.2),e.xp6(1),e.hij(" ",null==t.data||null==t.data.position?null:t.data.position.name," "),e.xp6(1),e.Udp("line-height",1.2)("font-size",.7,"em"),e.xp6(1),e.hij(" ",null==t.data||null==t.data.position?null:t.data.position.area," "),e.xp6(1),e.Udp("line-height",1.2)("font-size",.7,"em"),e.xp6(1),e.hij(" ",null==t.data||null==t.data.position?null:t.data.position.department," "),e.xp6(1),e.Udp("line-height",1.3)("font-size",.9,"em"),e.xp6(1),e.hij(" ",null==t.data||null==t.data.property?null:t.data.property.name," "),e.xp6(1),e.Q6J("ngIf",null===t.data.employment)}}let G=(()=>{class n{constructor(t,i){this.teamApiService=t,this.authStateService=i,this.data=[],this.selectionMode="multiple",this.selected=[],this.leaderChangeMode=!1,this.canMoveLeader=!1,this.subscriptions=new I.w0,this.jobsToMove=[],this.subscriptions.add(this.authStateService.authState.subscribe(s=>{var h;"SuperAdmin"==(null===(h=s.identity)||void 0===h?void 0:h.role)&&(this.canMoveLeader=!0)}))}ngOnInit(){this.fetchTopLevelJob()}createNodeFromJob(t,i=[]){return{key:t._id,type:"job",label:t.position.name,leaf:!1,data:{position:t.position,property:t.property,employment:t.employment},children:i,expanded:i&&0!==i.length||!1}}findChild(t,i){if(void 0===i&&(i=this.data[0]),i.key===t)return i;if(i.children)for(let s of i.children){const h=this.findChild(t,s);if(void 0!==h)return h}}flattenNode(t,i){if(void 0===i&&(i=[t]),t.children)for(let s of t.children)null==i||i.push(s),this.flattenNode(s,i);return i}nodeExpanded({node:t}){this.fetchChildrenForJob(t.key)}nodeCollapsed({node:t}){let i=this.flattenNode(t);i.shift(),this.selected=this.selected.filter(s=>!i.some(h=>h.key==s.key))}nodeSelected(t){this.selected.push(t.node)}nodeUnselected(t){this.selected=this.selected.filter(i=>i.key!=t.node.key)}getSelectedNodes(t){const i=this.flattenNode(this.data[0]);return t.map(s=>i.find(h=>h.key===s.key)).filter(s=>void 0!==s)}triggerLeaderChange(){this.jobsToMove=this.selected,this.selected=[],this.leaderChangeMode=!0,this.selectionMode="single"}cancelLeaderChange(){this.selected=this.jobsToMove,this.leaveLeaderChangeMode()}leaveLeaderChangeMode(){this.jobsToMove=[],this.leaderChangeMode=!1,this.selectionMode="multiple"}submitMoveLeader(){var t;const i=this.selected.pop();this.selected=[],console.log("New desired Leader: ",null==i?void 0:i.key),console.log("Jobs to move: ",null===(t=this.jobsToMove)||void 0===t?void 0:t.map(s=>s.key)),this.leaveLeaderChangeMode()}fetchTopLevelJob(){this.teamApiService.getTopMostJobInHierarchy().then(t=>this.teamApiService.getTeamByLeader(t.jobId)).then(t=>{let i=t.teamMembers.map(s=>this.createNodeFromJob(s));this.data=[this.createNodeFromJob(t,i)]})}fetchChildrenForJob(t){this.teamApiService.getTeamByLeader(t).then(i=>{var s;const h=this.findChild(i._id);if(void 0===h)return;let M=i.teamMembers.map(R=>this.createNodeFromJob(R,[]));if(h.children)for(let R of h.children){let y=M.findIndex(L=>L.key===R.key);-1!=y&&(R=Object.assign(Object.assign({},M[y]),{children:R.children}),M.splice(y,1))}null===(s=h.children)||void 0===s||s.push(...M),this.data=JSON.parse(JSON.stringify(this.data)),this.selected=this.getSelectedNodes(this.selected)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.U),e.Y36(D.V))},n.\u0275cmp=e.Xpm({type:n,selectors:[["org-chart-widget"]],decls:5,vars:7,consts:[["class","text-right",4,"ngIf"],[4,"ngIf"],[3,"value","selectionMode","selection","onNodeExpand","onNodeCollapse","onNodeSelect","onNodeUnselect"],["pTemplate","job"],[1,"text-right"],["class","btn btn-outline-primary mr-2","routerLink","/app/team",3,"queryParams",4,"ngIf"],["class","btn btn-outline-dark",3,"click",4,"ngIf"],["routerLink","/app/team",1,"btn","btn-outline-primary","mr-2",3,"queryParams"],["aria-hidden","true",1,"fas","fa-sitemap","pr-1"],[1,"btn","btn-outline-dark",3,"click"],["aria-hidden","true",1,"fas","fa-arrows-alt","pr-1"],["class","btn btn-warning",3,"click",4,"ngIf"],[1,"mt-2","alert","alert-info"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"mb-1"],[1,"mb-1","font-weight-light"],["class","mb-0",3,"line-height","font-size",4,"ngIf"],[1,"mb-0"],["aria-hidden","true",1,"fa","fa-info-circle","mr-1","text-warning"]],template:function(t,i){1&t&&(e.YNc(0,Q,3,2,"div",0),e.YNc(1,H,15,3,"div",1),e.TgZ(2,"alasta-overflow-shadow-container"),e.TgZ(3,"p-organizationChart",2),e.NdJ("onNodeExpand",function(h){return i.nodeExpanded(h)})("onNodeCollapse",function(h){return i.nodeCollapsed(h)})("onNodeSelect",function(h){return i.nodeSelected(h)})("onNodeUnselect",function(h){return i.nodeUnselected(h)}),e.YNc(4,q,9,19,"ng-template",3),e.qZA(),e.qZA()),2&t&&(e.Q6J("ngIf",!i.leaderChangeMode),e.xp6(1),e.Q6J("ngIf",i.leaderChangeMode&&i.canMoveLeader),e.xp6(2),e.Udp("flex-grow",1),e.Q6J("value",i.data)("selectionMode",i.selectionMode)("selection",i.selected))},directives:[o.O5,p.yS,A.t,U,l.jx],styles:[""]}),n})(),K=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["alasta-jobs"]],decls:7,vars:0,consts:[[1,"card"],[1,"card-body"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h4"),e._uU(3,"Organization Chart"),e.qZA(),e.TgZ(4,"p"),e._uU(5," You can view your full organization chart on this page and go to the Job Navigator for more fine-grained control. "),e.qZA(),e._UZ(6,"org-chart-widget"),e.qZA(),e.qZA())},directives:[G],styles:[""]}),n})();var $=g(6781),X=g(845);let ee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[o.ez,p.Bz.forChild([{path:"",component:K}]),w,X.hJ,$._]]}),n})()},845:(x,S,g)=>{g.d(S,{Hq:()=>b,hJ:()=>O,zx:()=>T});var o=g(5e3),e=g(5730),I=g(9808),v=g(5787),D=g(9783);function p(r,m){1&r&&o.GkF(0)}const A=function(r,m,a,d){return{"p-button-icon":!0,"p-button-icon-left":r,"p-button-icon-right":m,"p-button-icon-top":a,"p-button-icon-bottom":d}};function u(r,m){if(1&r&&o._UZ(0,"span",4),2&r){const a=o.oxw();o.Tol(a.loading?"p-button-loading-icon "+a.loadingIcon:a.icon),o.Q6J("ngClass",o.l5B(4,A,"left"===a.iconPos&&a.label,"right"===a.iconPos&&a.label,"top"===a.iconPos&&a.label,"bottom"===a.iconPos&&a.label)),o.uIk("aria-hidden",!0)}}function l(r,m){if(1&r&&(o.TgZ(0,"span",5),o._uU(1),o.qZA()),2&r){const a=o.oxw();o.uIk("aria-hidden",a.icon&&!a.label),o.xp6(1),o.Oqu(a.label||"\xa0")}}function f(r,m){if(1&r&&(o.TgZ(0,"span",4),o._uU(1),o.qZA()),2&r){const a=o.oxw();o.Tol(a.badgeClass),o.Q6J("ngClass",a.badgeStyleClass()),o.xp6(1),o.Oqu(a.badge)}}const _=function(r,m,a,d,N){return{"p-button p-component":!0,"p-button-icon-only":r,"p-button-vertical":m,"p-disabled":a,"p-button-loading":d,"p-button-loading-label-only":N}},C=["*"];let b=(()=>{class r{constructor(a){this.el=a,this.iconPos="left",this.loadingIcon="pi pi-spinner pi-spin",this._loading=!1}ngAfterViewInit(){this._initialStyleClass=this.el.nativeElement.className,e.p.addMultipleClasses(this.el.nativeElement,this.getStyleClass()),(this.icon||this.loading)&&this.createIconEl();let a=document.createElement("span");this.icon&&!this.label&&a.setAttribute("aria-hidden","true"),a.className="p-button-label",this.label?a.appendChild(document.createTextNode(this.label)):a.innerHTML="&nbsp;",this.el.nativeElement.appendChild(a),this.initialized=!0}getStyleClass(){let a="p-button p-component";return this.icon&&!this.label&&(a+=" p-button-icon-only"),this.loading&&(a+=" p-disabled p-button-loading",!this.icon&&this.label&&(a+=" p-button-loading-label-only")),a}setStyleClass(){let a=this.getStyleClass();this.el.nativeElement.className=a+" "+this._initialStyleClass}createIconEl(){let a=document.createElement("span");a.className="p-button-icon",a.setAttribute("aria-hidden","true");let d=this.label?"p-button-icon-"+this.iconPos:null;d&&e.p.addClass(a,d);let N=this.getIconClass();N&&e.p.addMultipleClasses(a,N);let E=e.p.findSingle(this.el.nativeElement,".p-button-label");E?this.el.nativeElement.insertBefore(a,E):this.el.nativeElement.appendChild(a)}getIconClass(){return this.loading?"p-button-loading-icon "+this.loadingIcon:this._icon}setIconClass(){let a=e.p.findSingle(this.el.nativeElement,".p-button-icon");a?a.className=this.iconPos?"p-button-icon p-button-icon-"+this.iconPos+" "+this.getIconClass():"p-button-icon "+this.getIconClass():this.createIconEl()}removeIconElement(){let a=e.p.findSingle(this.el.nativeElement,".p-button-icon");this.el.nativeElement.removeChild(a)}get label(){return this._label}set label(a){this._label=a,this.initialized&&(e.p.findSingle(this.el.nativeElement,".p-button-label").textContent=this._label||"&nbsp;",(this.loading||this.icon)&&this.setIconClass(),this.setStyleClass())}get icon(){return this._icon}set icon(a){this._icon=a,this.initialized&&(this.setIconClass(),this.setStyleClass())}get loading(){return this._loading}set loading(a){this._loading=a,this.initialized&&(this.loading||this.icon?this.setIconClass():this.removeIconElement(),this.setStyleClass())}ngOnDestroy(){this.initialized=!1}}return r.\u0275fac=function(a){return new(a||r)(o.Y36(o.SBq))},r.\u0275dir=o.lG2({type:r,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading"}}),r})(),T=(()=>{class r{constructor(){this.type="button",this.iconPos="left",this.loading=!1,this.loadingIcon="pi pi-spinner pi-spin",this.onClick=new o.vpe,this.onFocus=new o.vpe,this.onBlur=new o.vpe}ngAfterContentInit(){this.templates.forEach(a=>{a.getType(),this.contentTemplate=a.template})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&1===String(this.badge).length}}}return r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=o.Xpm({type:r,selectors:[["p-button"]],contentQueries:function(a,d,N){if(1&a&&o.Suo(N,D.jx,4),2&a){let E;o.iGM(E=o.CRH())&&(d.templates=E)}},hostAttrs:[1,"p-element"],inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:"disabled",loading:"loading",loadingIcon:"loadingIcon",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel"},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},ngContentSelectors:C,decls:6,vars:17,consts:[["pRipple","",3,"ngStyle","disabled","ngClass","click","focus","blur"],[4,"ngTemplateOutlet"],[3,"ngClass","class",4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass"],[1,"p-button-label"]],template:function(a,d){1&a&&(o.F$t(),o.TgZ(0,"button",0),o.NdJ("click",function(E){return d.onClick.emit(E)})("focus",function(E){return d.onFocus.emit(E)})("blur",function(E){return d.onBlur.emit(E)}),o.Hsn(1),o.YNc(2,p,1,0,"ng-container",1),o.YNc(3,u,1,9,"span",2),o.YNc(4,l,2,2,"span",3),o.YNc(5,f,2,4,"span",2),o.qZA()),2&a&&(o.Tol(d.styleClass),o.Q6J("ngStyle",d.style)("disabled",d.disabled||d.loading)("ngClass",o.qbA(11,_,d.icon&&!d.label,("top"===d.iconPos||"bottom"===d.iconPos)&&d.label,d.disabled||d.loading,d.loading,d.loading&&!d.icon&&d.label)),o.uIk("type",d.type)("aria-label",d.ariaLabel),o.xp6(2),o.Q6J("ngTemplateOutlet",d.contentTemplate),o.xp6(1),o.Q6J("ngIf",!d.contentTemplate&&(d.icon||d.loading)),o.xp6(1),o.Q6J("ngIf",!d.contentTemplate),o.xp6(1),o.Q6J("ngIf",!d.contentTemplate&&d.badge))},directives:[v.H,I.PC,I.mk,I.tP,I.O5],encapsulation:2,changeDetection:0}),r})(),O=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=o.oAB({type:r}),r.\u0275inj=o.cJS({imports:[[I.ez,v.T]]}),r})()}}]);