"use strict";(self.webpackChunkalasta_ui=self.webpackChunkalasta_ui||[]).push([[135],{76:(Z,C,a)=>{a.d(C,{S:()=>f});var e=a(1571),l=a(6895);function A(_,h){if(1&_&&(e.TgZ(0,"p",6),e._uU(1),e.qZA()),2&_){const v=e.oxw();e.xp6(1),e.Oqu(v.context)}}function p(_,h){1&_&&(e.TgZ(0,"p")(1,"strong"),e._uU(2,"This action cannot be undone."),e.qZA()())}let f=(()=>{class _{constructor(){this.modalHeader="Delete?",this.context="",this.confirmationPrompt="Are you sure you want to delete?",this.canUndo=!1,this.rejectButtonText="Cancel",this.confirmButtonIconClasses="fa fa-trash-alt",this.confirmButtonText="Delete",this.onConfirm=new e.vpe,this.onReject=new e.vpe}reject(){this.onReject.emit()}confirm(){this.onConfirm.emit()}}return _.\u0275fac=function(v){return new(v||_)},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-shared-confirmation"]],inputs:{modalHeader:"modalHeader",context:"context",confirmationPrompt:"confirmationPrompt",canUndo:"canUndo",rejectButtonText:"rejectButtonText",confirmButtonIconClasses:"confirmButtonIconClasses",confirmButtonText:"confirmButtonText"},outputs:{onConfirm:"onConfirm",onReject:"onReject"},decls:20,vars:7,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body","text-center"],["class","my-3",4,"ngIf"],[1,"my-3"],[4,"ngIf"],[1,"modal-footer"],[1,"text-right"],[1,"btn","btn-danger",3,"click"],["aria-hidden","true",3,"ngClass"],[1,"btn","btn-primary","ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-times"]],template:function(v,s){1&v&&(e.TgZ(0,"div",0)(1,"h4",1)(2,"span"),e._uU(3),e.qZA()(),e.TgZ(4,"button",2),e.NdJ("click",function(){return s.reject()}),e.TgZ(5,"span",3),e._uU(6,"\xd7"),e.qZA()()(),e.TgZ(7,"div",4),e.YNc(8,A,2,1,"p",5),e.TgZ(9,"p",6),e._uU(10),e.qZA(),e.YNc(11,p,3,0,"p",7),e.qZA(),e.TgZ(12,"div",8)(13,"div",9)(14,"button",10),e.NdJ("click",function(){return s.confirm()}),e._UZ(15,"i",11),e._uU(16),e.qZA(),e.TgZ(17,"button",12),e.NdJ("click",function(){return s.reject()}),e._UZ(18,"i",13),e._uU(19),e.qZA()()()),2&v&&(e.xp6(3),e.Oqu(s.modalHeader),e.xp6(5),e.Q6J("ngIf",s.context),e.xp6(2),e.Oqu(s.confirmationPrompt),e.xp6(1),e.Q6J("ngIf",!s.canUndo),e.xp6(4),e.Q6J("ngClass",s.confirmButtonIconClasses),e.xp6(1),e.hij(" ",s.confirmButtonText," "),e.xp6(3),e.hij(" ",s.rejectButtonText," "))},dependencies:[l.mk,l.O5],encapsulation:2}),_})()},1892:(Z,C,a)=>{a.d(C,{C:()=>A});var e=a(6895),l=a(1571);let A=(()=>{class p{}return p.\u0275fac=function(_){return new(_||p)},p.\u0275mod=l.oAB({type:p}),p.\u0275inj=l.cJS({imports:[e.ez]}),p})()},9913:(Z,C,a)=>{a.d(C,{Z:()=>y});var e=a(1571),l=a(433),A=a(8372),p=a(9766),f=a(6895),_=a(2210),h=a(805),v=a(5722);function s(u,t){if(1&u&&(e.TgZ(0,"div",9)(1,"em"),e._uU(2),e.qZA()()),2&u){const r=e.oxw(2);e.xp6(2),e.Oqu(r.filter.metadata.visibleName)}}const g=function(){return[]};function M(u,t){if(1&u&&(e.TgZ(0,"p-dropdown",7),e.YNc(1,s,3,1,"ng-template",8),e.qZA()),2&u){const r=e.oxw();e.Q6J("formControl",r.control)("options",r.filter.metadata.options||e.DdM(5,g))("filter",!0)("placeholder",r.filter.metadata.visibleName)("showClear",r.filter.value&&!r.filter.metadata.required)}}function T(u,t){if(1&u&&e._UZ(0,"p-multiSelect",10),2&u){const r=e.oxw();e.Q6J("formControl",r.control)("options",r.filter.metadata.options||e.DdM(3,g))("placeholder",r.filter.metadata.visibleName)}}function R(u,t){if(1&u&&e._UZ(0,"p-multiSelect",11),2&u){const r=e.oxw();e.Q6J("formControl",r.control)("filter",!1)("options",r.filter.metadata.options||e.DdM(4,g))("placeholder",r.filter.metadata.visibleName)}}function b(u,t){if(1&u&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&u){const r=t.$implicit;e.Q6J("value",r.value),e.xp6(1),e.Oqu(r.name)}}function U(u,t){if(1&u&&(e.TgZ(0,"select",12),e.YNc(1,b,2,2,"option",13),e.qZA()),2&u){const r=e.oxw();e.Q6J("formControl",r.control),e.xp6(1),e.Q6J("ngForOf",r.filter.metadata.options)}}function I(u,t){if(1&u){const r=e.EpF();e.TgZ(0,"a",15),e.NdJ("click",function(){e.CHM(r);const O=e.oxw();return e.KtG(O.onRemove.emit())}),e._UZ(1,"i",16),e.qZA()}}let y=(()=>{class u{constructor(){this.canRemove=!0,this.filterClass="",this.onRemove=new e.vpe}get FilterType(){return p.v}ngOnInit(){this.control=new l.p4(this.filter.value),this.control.valueChanges.pipe((0,A.b)(200)).subscribe(r=>{this.filter.value=r}),this.filter.valueChanges.subscribe(()=>{this.control.setValue(this.filter.value,{emitEvent:!1})})}}return u.\u0275fac=function(r){return new(r||u)},u.\u0275cmp=e.Xpm({type:u,selectors:[["alasta-filter-item"]],inputs:{filter:"filter",canRemove:"canRemove",filterClass:"filterClass"},outputs:{onRemove:"onRemove"},decls:7,vars:6,consts:[["id","filter-item",3,"ngClass"],["id","filter-value",3,"ngSwitch"],["optionLabel","name","optionValue","value","styleClass","alasta-filter-dropdown",3,"formControl","options","filter","placeholder","showClear",4,"ngSwitchCase"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","options","placeholder",4,"ngSwitchCase"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","filter","options","placeholder",4,"ngSwitchCase"],[3,"formControl",4,"ngSwitchDefault"],["id","filter-remover","class","btn btn-sm btn-secondary-outline p-1",3,"click",4,"ngIf"],["optionLabel","name","optionValue","value","styleClass","alasta-filter-dropdown",3,"formControl","options","filter","placeholder","showClear"],["pTemplate","header"],[1,"filter-dropdown-header"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","options","placeholder"],["optionLabel","name","optionValue","value","selectedItemsLabel","{0} items selected",3,"formControl","filter","options","placeholder"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["id","filter-remover",1,"btn","btn-sm","btn-secondary-outline","p-1",3,"click"],[1,"fas","fa-trash-alt"]],template:function(r,E){1&r&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,M,2,6,"p-dropdown",2),e.YNc(3,T,1,4,"p-multiSelect",3),e.YNc(4,R,1,5,"p-multiSelect",4),e.YNc(5,U,2,2,"select",5),e.qZA(),e.YNc(6,I,2,0,"a",6),e.qZA()),2&r&&(e.Q6J("ngClass",E.filterClass),e.xp6(1),e.Q6J("ngSwitch",E.filter.metadata.type),e.xp6(1),e.Q6J("ngSwitchCase",E.FilterType.DROPDOWN_SEARCH),e.xp6(1),e.Q6J("ngSwitchCase",E.FilterType.MULTISELECT_SEARCH),e.xp6(1),e.Q6J("ngSwitchCase",E.FilterType.MULTISELECT),e.xp6(2),e.Q6J("ngIf",E.canRemove))},dependencies:[f.mk,f.sg,f.O5,f.RF,f.n9,f.ED,l.YN,l.Kr,l.EJ,l.JJ,l.oH,_.Lt,h.jx,v.NU],styles:["#filter-item[_ngcontent-%COMP%]{border-radius:.25rem;display:inline-flex;justify-content:center;align-items:center}#filter-item[_ngcontent-%COMP%]   #filter-remover[_ngcontent-%COMP%]{margin:0 .3rem;width:1.4rem;height:1.4rem;line-height:0;border-radius:.25%}.filter-dropdown-header[_ngcontent-%COMP%]{padding:.2rem .75rem;background-color:#efefef}"]}),u})()},7064:(Z,C,a)=>{a.d(C,{i:()=>v});var e=a(6895),l=a(433),A=a(9245),p=a(3345),f=a(2210),_=a(5722),h=a(1571);let v=(()=>{class s{}return s.\u0275fac=function(M){return new(M||s)},s.\u0275mod=h.oAB({type:s}),s.\u0275inj=h.cJS({imports:[e.ez,l.UX,A.mr,p.k,f.kW,_.q4]}),s})()},9766:(Z,C,a)=>{a.d(C,{v:()=>e});var e=(()=>{return(l=e||(e={}))[l.DROPDOWN_SEARCH=0]="DROPDOWN_SEARCH",l[l.MULTISELECT_SEARCH=1]="MULTISELECT_SEARCH",l[l.MULTISELECT=2]="MULTISELECT",l[l.TEXT_INPUT=3]="TEXT_INPUT",l[l.TOGGLE=4]="TOGGLE",e;var l})()},6817:(Z,C,a)=>{a.d(C,{w:()=>l});var e=a(1571);class l{constructor(p,f){this.valueChanges=new e.vpe,this.metadata=p,this.value=f}set value(p){this.setValue(p)}setValue(p,f=!0,_){this._value=p,f&&this.valueChanges.emit({value:this._value,additional:_})}get value(){return this._value}}},8283:(Z,C,a)=>{a.d(C,{B:()=>_});var e=a(3905),l=a(4004),A=a(2340),p=a(1571),f=a(529);let _=(()=>{class h{constructor(s){this.http=s,this.serverUrl=A.N.v2apiServer}listAccounts(s,g,M,T){return(0,e.z)(this.http.post(this.serverUrl+"account/list",T,{params:{...s?{search:s}:{},...M?{page:M}:{},...g?{count:g}:{}}}).pipe(R=>R))}sendRegistrationReminder(s){return(0,e.z)(this.http.post(this.serverUrl+"account/remind-registration/"+s,{}).pipe((0,l.U)(g=>({account:g}))))}editAccount(s,g,M){return(0,e.z)(this.http.put(this.serverUrl+"account/"+s,{...g?{email:g}:{},...M?{role:M}:{}}).pipe((0,l.U)(T=>({account:T}))))}getAccount(s){return(0,e.z)(this.http.get(this.serverUrl+"account/"+s).pipe((0,l.U)(g=>({account:g}))))}}return h.\u0275fac=function(s){return new(s||h)(p.LFG(f.eN))},h.\u0275prov=p.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},2135:(Z,C,a)=>{a.r(C),a.d(C,{AccountsModule:()=>st});var e=a(6895),l=a(433),A=a(4789),p=a(5593),f=a(1740),_=a(793),h=a(1892),v=a(7064),s=a(2342),g=a(3345),M=a(5973),T=a(3113),R=a(5861),b=a(727),U=a(8372),I=a(6817),y=a(9766),u=a(625),t=a(1571),r=a(8283),E=a(9649),O=a(171),S=a(2733),P=a(805),D=a(9913),L=a(2962),N=a(76),J=a(1507);const k=function(o){return["/","app","talent","view",o]};function B(o,d){if(1&o&&(t.TgZ(0,"div",17)(1,"div",18)(2,"p"),t._uU(3," This account is associated with the following talent "),t.qZA()(),t.TgZ(4,"div",19)(5,"a",20),t._UZ(6,"i",21),t._uU(7,"View Talent "),t.qZA()(),t.TgZ(8,"div",22)(9,"h6"),t._uU(10,"Talent name"),t.qZA(),t.TgZ(11,"p"),t._uU(12),t.qZA()(),t.TgZ(13,"div",22)(14,"h6"),t._uU(15,"Keiro Profile ID"),t.qZA(),t.TgZ(16,"p"),t._uU(17),t.qZA()()()),2&o){const n=t.oxw();t.xp6(5),t.Q6J("routerLink",t.VKq(4,k,null==n.talent?null:n.talent._id)),t.xp6(7),t.AsE("",null==n.talent||null==n.talent.name?null:n.talent.name.given," ",null==n.talent||null==n.talent.name?null:n.talent.name.last,""),t.xp6(5),t.Oqu(n.talent._id)}}function K(o,d){1&o&&(t.TgZ(0,"h6",23),t._uU(1,"There is no associated Talent for this account. Please contact Alasta Support."),t.qZA())}function F(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.editMode=!0)}),t._UZ(1,"i",25),t._uU(2,"Edit "),t.qZA()}}function W(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(c){t.CHM(n);const m=t.oxw(2);return m.onClickRemind.emit(c),t.KtG(m.clickedRemind=!0)}),t._UZ(1,"i",30),t._uU(2,"Remind "),t.qZA()}if(2&o){const n=t.oxw(2);t.Q6J("disabled",n.clickedRemind)}}function Q(o,d){if(1&o&&(t.TgZ(0,"div",26)(1,"div",27)(2,"h6"),t._uU(3,"Login email address"),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.YNc(6,W,3,1,"button",28),t.qZA()(),t.TgZ(7,"div",27)(8,"h6"),t._uU(9,"Keiro access level"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"roleName"),t.qZA()()()),2&o){const n=t.oxw();t.xp6(5),t.hij(" ",null==n.account?null:n.account.email," "),t.xp6(1),t.Q6J("ngIf",!(null!=n.account&&n.account.pwd)),t.xp6(5),t.Oqu(t.lcZ(12,3,null==n.account?null:n.account.role))}}function Y(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"keiro-account-form",31),t.NdJ("statusChanges",function(c){t.CHM(n);const m=t.oxw();return t.KtG(m.formStatusChange(c))})("valueChanges",function(c){t.CHM(n);const m=t.oxw();return t.KtG(m.formValueChange(c))}),t.qZA()}if(2&o){const n=t.oxw();t.Q6J("initialValue",n.account)("canCreateRoles",n.canCreateRoles)}}function H(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"div",32)(1,"button",33),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.editMode=!1)}),t._UZ(2,"i",34),t._uU(3,"Cancel "),t.qZA(),t.TgZ(4,"button",35),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.onSumbitChange.emit(c.formValue))}),t._UZ(5,"i",36),t._uU(6,"Save "),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(4),t.Q6J("disabled",!n.onlyRoleChange&&!n.formValid||n.processing)}}function j(o,d){1&o&&t._UZ(0,"hr",7),2&o&&t.Udp("width",80,"%")}function G(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"div"),t.YNc(1,j,1,2,"hr",37),t.TgZ(2,"button",38),t.NdJ("click",function(c){t.CHM(n);const m=t.oxw();return t.KtG(m.onClickRevoke.emit(c))}),t._UZ(3,"i",39),t._uU(4,"Revoke account "),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.talent)}}let q=(()=>{class o{constructor(){this.editMode=!1,this.canModifyAccount=!1,this.processing=!1,this.onClickRemind=new t.vpe,this.onClickRevoke=new t.vpe,this.onSumbitChange=new t.vpe,this.onCloseModal=new t.vpe,this.formValid=!1,this.onlyRoleChange=!1,this.clickedRemind=!1}set account(n){this.editMode=!1,this._account=n}get account(){return this._account}formStatusChange(n){this.formValid="VALID"===n}formValueChange(n){this.onlyRoleChange=this.account?.email===n.email&&this.account.role!=n.role,this.formValue=n}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["org-accounts-manage-account-modal"]],inputs:{account:"account",talent:"talent",canCreateRoles:"canCreateRoles",canModifyAccount:"canModifyAccount",processing:"processing"},outputs:{onClickRemind:"onClickRemind",onClickRevoke:"onClickRevoke",onSumbitChange:"onSumbitChange",onCloseModal:"onCloseModal"},decls:26,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["class","form-row",4,"ngIf","ngIfElse"],["noAssociatedTalent",""],[1,"my-3"],["class","btn btn-sm btn-secondary",3,"click",4,"ngIf"],["class","row",4,"ngIf","ngIfElse"],["accountEditMode",""],["class","mb-2",4,"ngIf"],[4,"ngIf"],[1,"modal-footer"],[1,"text-right"],[1,"btn","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-times"],[1,"form-row"],[1,"col"],[1,"col-auto"],[1,"btn","btn-sm","btn-secondary",3,"routerLink"],["aria-hidden","true",1,"fa","fa-external-link-alt","mr-1"],[1,"col-12"],[1,"alert","alert-warning"],[1,"btn","btn-sm","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-pencil-alt","mr-1"],[1,"row"],[1,"col-12","col-md-6"],["class","btn btn-sm btn-secondary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-sm","btn-secondary",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-paper-plane","mr-1"],[3,"initialValue","canCreateRoles","statusChanges","valueChanges"],[1,"mb-2"],[1,"btn","btn-primary","mr-1",3,"click"],["aria-hidden","true",1,"fa","fa-times","mr-1"],[1,"btn","btn-secondary",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-check","mr-1"],["class","my-3",3,"width",4,"ngIf"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],["aria-hidden","true",1,"fa","fa-door-closed","mr-1"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"h4",1),t._uU(2," Manage Keiro Account "),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(m){return i.onCloseModal.emit(m)}),t.TgZ(4,"span",3),t._uU(5,"\xd7"),t.qZA()()(),t.TgZ(6,"div",4)(7,"h5"),t._uU(8,"Associated Talent"),t.qZA(),t.YNc(9,B,18,6,"div",5),t.YNc(10,K,2,0,"ng-template",null,6,t.W1O),t._UZ(12,"hr",7),t.TgZ(13,"h5"),t._uU(14," Account information "),t.YNc(15,F,3,0,"button",8),t.qZA(),t.YNc(16,Q,13,5,"div",9),t.YNc(17,Y,1,2,"ng-template",null,10,t.W1O),t.YNc(19,H,7,1,"div",11),t.YNc(20,G,5,1,"div",12),t.qZA(),t.TgZ(21,"div",13)(22,"div",14)(23,"button",15),t.NdJ("click",function(m){return i.onCloseModal.emit(m)}),t._UZ(24,"i",16),t._uU(25," Close "),t.qZA()()()),2&n){const c=t.MAs(11),m=t.MAs(18);t.xp6(9),t.Q6J("ngIf",i.talent)("ngIfElse",c),t.xp6(3),t.Udp("width",80,"%"),t.xp6(3),t.Q6J("ngIf",i.canModifyAccount&&!i.editMode),t.xp6(1),t.Q6J("ngIf",0==i.editMode)("ngIfElse",m),t.xp6(3),t.Q6J("ngIf",i.editMode),t.xp6(1),t.Q6J("ngIf",i.canModifyAccount&&i.talent)}},dependencies:[e.O5,A.yS,J.g,T.p]}),o})();const V=["searchInput"];function z(o,d){1&o&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"Email"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Role"),t.qZA(),t.TgZ(5,"th"),t._uU(6," Completed account? "),t._UZ(7,"app-shared-icon-tooltip",16),t.qZA(),t._UZ(8,"th"),t.qZA())}function X(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(n);const c=t.oxw(2).$implicit,m=t.oxw();return t.KtG(m.sendAccountRegisterEmail(c._id))}),t.qZA()}if(2&o){const n=t.oxw(2).$implicit,i=t.oxw();t.Q6J("loading",i.sendingReminder)("disabled",i.wasRecentlyReminded(n._id))}}function $(o,d){1&o&&(t.TgZ(0,"span",22),t._UZ(1,"i",23),t.TgZ(2,"em"),t._uU(3,"Email sent"),t.qZA()())}function tt(o,d){if(1&o&&(t.TgZ(0,"span"),t.YNc(1,X,1,2,"button",19),t.YNc(2,$,4,0,"ng-template",null,20,t.W1O),t.qZA()),2&o){const n=t.MAs(3),i=t.oxw().$implicit,c=t.oxw();t.xp6(1),t.Q6J("ngIf",!c.wasRecentlyReminded(i._id))("ngIfElse",n)}}function et(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"td")(1,"button",24),t.NdJ("click",function(){t.CHM(n);const c=t.oxw().$implicit,m=t.oxw(),w=t.MAs(23);return t.KtG(m.openAccountManagementModal(w,c))}),t.qZA()()}if(2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("loading",n.loadingTalentInfo)}}function nt(o,d){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"roleName"),t.qZA(),t.TgZ(6,"td")(7,"span",17),t._uU(8),t.qZA(),t.YNc(9,tt,4,2,"span",18),t.qZA(),t.YNc(10,et,2,1,"td",18),t.qZA()),2&o){const n=d.$implicit,i=t.oxw();t.xp6(2),t.Oqu(n.email),t.xp6(2),t.Oqu(t.lcZ(5,5,n.role)),t.xp6(4),t.hij(" ",n.pwd?"Yes":"No"," "),t.xp6(1),t.Q6J("ngIf",!n.pwd),t.xp6(1),t.Q6J("ngIf",i.canEditExistingPositions)}}function ot(o,d){if(1&o&&(t.TgZ(0,"small"),t._uU(1),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.hij("",n.total," total")}}function at(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"app-shared-confirmation",25),t.NdJ("onConfirm",function(){t.CHM(n);const c=t.oxw();return c.revokeAccount(c.targetTalent._id,c.targetAccount.email),t.KtG(c.modalsController.closeUpperModal())})("onReject",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.modalsController.closeUpperModal())}),t.qZA()}2&o&&t.Q6J("canUndo",!0)}function it(o,d){if(1&o){const n=t.EpF();t.TgZ(0,"org-accounts-manage-account-modal",26),t.NdJ("onClickRevoke",function(){t.CHM(n);const c=t.oxw(),m=t.MAs(21);return t.KtG(c.modalsController.openModal(m))})("onClickRemind",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.sendAccountRegisterEmail(c.targetAccount._id))})("onSumbitChange",function(c){t.CHM(n);const m=t.oxw();return t.KtG(m.handleAddEditSubmission(c))})("onCloseModal",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.modalsController.closeUpperModal())}),t.qZA()}if(2&o){const n=t.oxw();t.Q6J("talent",n.targetTalent)("account",n.targetAccount)("canCreateRoles",n.canCreateRoles)("canModifyAccount",n.currentAccountId!=(null==n.targetAccount?null:n.targetAccount._id))("processing",n.processingModalRequest)}}const ct=function(){return[10,25,50]};let lt=(()=>{class o{constructor(n,i,c,m,w,rt){this.accountsServiceApi=n,this.talentsManagementServiceApi=i,this.authStateService=c,this.roleNamePipe=m,this.modalsController=w,this.messageService=rt,this.canEditExistingPositions=!0,this.searchInputControl=new l.p4,this.subscriptions=new b.w0,this.total=0,this.page=0,this.step=10,this.rows=[],this.loadingIndicator=!1,this.sendingReminder=!1,this.recentlyReminded=[],this.wasRecentlyReminded=x=>this.recentlyReminded.some(ut=>ut._id==x),this.canCreateRoles=[u.u.ADMIN,u.u.MANAGER,u.u.EMPLOYEE],this.processingModalRequest=!1,this.loadingTalentInfo=!1,this.roleFilter=new I.w({id:"roleFilter",type:y.v.MULTISELECT,visibleName:"Select Roles",key:"roles",groupOrder:1,options:this.getRoleOptions()},this.getRoleOptions().map(x=>x.value)),this.subscriptions.add(this.searchInputControl.valueChanges.pipe((0,U.b)(350)).subscribe(x=>{this.searchInputControl.valid&&this.fetchAccountsWithPagination()})),this.subscriptions.add(this.roleFilter.valueChanges.pipe((0,U.b)(350)).subscribe(x=>{this.fetchAccountsWithPagination()})),this.subscriptions.add(this.authStateService.authState.subscribe(x=>{this.currentAccountId=x.identity?.accountId}))}ngAfterViewInit(){this.input?.nativeElement.focus()}ngOnDestroy(){this.modalsController.closeUpperModal(),this.subscriptions.unsubscribe()}getRoleOptions(){return Object.values(u.u).filter(n=>n!=u.u.SUPER_ADMIN).map(n=>({name:this.roleNamePipe.transform(n),value:n}))}showSuccessMessage(n,i){this.messageService.add({severity:"success",summary:n,detail:i,life:3e3})}showErrorMessage(n,i){this.messageService.add({severity:"error",summary:n,detail:i,life:4e3})}setPage(n){this.step=n.rows,this.page=Math.floor(n.first/n.rows),this.fetchAccountsWithPagination()}openAccountManagementModal(n,i){var c=this;return(0,R.Z)(function*(){c.targetAccount=i,c.loadingTalentInfo=!0,c.targetTalent=yield c.fetchTalentInfoForAccount(i._id),c.loadingTalentInfo=!1,c.modalsController.openModal(n,{class:"modal-lg"})})()}fetchAccountsWithPagination(){this.loadingIndicator=!0,this.accountsServiceApi.listAccounts(this.searchInputControl.value,this.step,this.page,{roles:this.roleFilter.value}).then(n=>{this.rows=n.paginatedList,this.total=n.totalElements}).catch(()=>{this.showErrorMessage("Error","Your request could not be processed")}).finally(()=>{this.loadingIndicator=!1})}sendAccountRegisterEmail(n){this.sendingReminder=!0,this.accountsServiceApi.sendRegistrationReminder(n).then(i=>{this.recentlyReminded.push(i.account)}).catch(()=>{this.showErrorMessage("Error","There was an error sending the email")}).finally(()=>{this.sendingReminder=!1})}fetchTalentInfoForAccount(n){var i=this;return(0,R.Z)(function*(){return i.talentsManagementServiceApi.getTalentByAccount(n).then(c=>c.talent).catch(()=>{i.showErrorMessage("Error","There was an error loading the Talent information")})})()}handleAddEditSubmission(n){null!=this.targetAccount?(this.processingModalRequest=!0,this.accountsServiceApi.editAccount(this.targetAccount?._id,n.email!==this.targetAccount.email?n.email:void 0,n.role!==this.targetAccount.role?n.role:void 0).then(i=>this.handleSuccessEdit(i.account)).catch(()=>{this.showErrorMessage("Error","There was an error while editing this Account")}).finally(()=>{this.processingModalRequest=!1})):console.warn("No target account")}handleSuccessEdit(n){this.targetAccount=n,this.showSuccessMessage("Edited","Successfully edited the account"),this.fetchAccountsWithPagination()}revokeAccount(n,i){this.talentsManagementServiceApi.revokeTalentsAccount(n).then(c=>{this.targetTalent=void 0,this.modalsController.closeUpperModal(),this.fetchAccountsWithPagination(),this.showSuccessMessage("Revoked","Successfully revoked the account for "+i)}).catch(()=>{this.showErrorMessage("Error","There was an error while editing this Account")})}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(r.B),t.Y36(E.C),t.Y36(O.V),t.Y36(T.p),t.Y36(S.l),t.Y36(P.ez))},o.\u0275cmp=t.Xpm({type:o,selectors:[["alasta-accounts"]],viewQuery:function(n,i){if(1&n&&t.Gf(V,5),2&n){let c;t.iGM(c=t.CRH())&&(i.input=c.first)}},decls:24,vars:11,consts:[[1,"card"],[1,"card-body"],[1,"form-row"],[1,"mb-1","col","order-2","order-md-1"],["filterClass","border border-primary",3,"filter","canRemove"],[1,"p-fluid","mb-1","col-12","col-md-6","col-lg-5","order-1","order-md-2"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search by email address",3,"formControl"],["searchInput",""],["styleClass","p-datatable-sm","responsiveLayout","scroll",3,"value","lazy","loading","paginator","rows","totalRecords","rowsPerPageOptions","onLazyLoad"],["pTemplate","header"],["pTemplate","body"],["pTemplate","paginatorleft"],["revokeAccountModal",""],["manageAccountModal",""],["accentLevel","light","iconClasses","fa fa-info-circle","placement","bottom","tooltipMessage","If this user has set a password to complete their account yet."],[1,"align-middle"],[4,"ngIf"],["pButton","","class","p-button-sm p-button-rounded p-button-outlined d-inline align-middle","icon","fas fa-paper-plane","label","Remind",3,"loading","disabled","click",4,"ngIf","ngIfElse"],["sentEmail",""],["pButton","","icon","fas fa-paper-plane","label","Remind",1,"p-button-sm","p-button-rounded","p-button-outlined","d-inline","align-middle",3,"loading","disabled","click"],[1,"text-success"],["aria-hidden","true",1,"fa","fa-check","mx-1"],["pButton","","icon","fas fa-user-cog","label","Options",1,"p-button-secondary","p-button-rounded",3,"loading","click"],["modalHeader","Revoke this account?","confirmButtonText","Revoke account","confirmButtonIconClasses","fa fa-door-closed","context","This account will be revoked, but the talent's profile will remain. Another account can be created for this talent at any time in the future.","confirmationPrompt","",3,"canUndo","onConfirm","onReject"],[3,"talent","account","canCreateRoles","canModifyAccount","processing","onClickRevoke","onClickRemind","onSumbitChange","onCloseModal"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h4"),t._uU(3,"Accounts"),t.qZA(),t.TgZ(4,"p"),t._uU(5," This is the list of all accounts that can access the Keiro Talent Management system."),t._UZ(6,"br"),t._uU(7," Here you can manage these accounts such as revoke access and change roles. "),t.qZA(),t.TgZ(8,"div",2)(9,"div",3),t._UZ(10,"alasta-filter-item",4),t.qZA(),t.TgZ(11,"div",5)(12,"span",6),t._UZ(13,"i",7)(14,"input",8,9),t.qZA()()(),t.TgZ(16,"p-table",10),t.NdJ("onLazyLoad",function(m){return i.setPage(m)}),t.YNc(17,z,9,0,"ng-template",11),t.YNc(18,nt,11,7,"ng-template",12),t.YNc(19,ot,2,1,"ng-template",13),t.qZA()()(),t.YNc(20,at,1,1,"ng-template",null,14,t.W1O),t.YNc(22,it,1,5,"ng-template",null,15,t.W1O)),2&n&&(t.xp6(10),t.Q6J("filter",i.roleFilter)("canRemove",!1),t.xp6(4),t.Q6J("formControl",i.searchInputControl),t.xp6(2),t.Q6J("value",i.rows)("lazy",!0)("loading",i.loadingIndicator)("paginator",!0)("rows",i.step)("totalRecords",i.total)("rowsPerPageOptions",t.DdM(10,ct)))},dependencies:[e.O5,l.Fj,l.JJ,l.oH,_.iA,P.jx,f.o,p.Hq,D.Z,L.s,N.S,q,T.p]}),o})(),st=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[T.p],imports:[e.ez,A.Bz.forChild([{path:"",component:lt}]),l.UX,_.U$,f.j,p.hJ,v.i,M.s,g.k,s.M,h.C]}),o})()}}]);